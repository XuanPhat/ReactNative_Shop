f732a91254571ef5719d8de91594eb29
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.Avatar = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _react = _interopRequireDefault(require("react"));

var _reactNative = require("react-native");

var _lodash = _interopRequireDefault(require("lodash.isequal"));

var _config = require("../config");

var _helpers = require("../helpers");

var _Icon = _interopRequireDefault(require("../icons/Icon"));

var _Image = _interopRequireDefault(require("../image/Image"));

var _Accessory = _interopRequireDefault(require("./Accessory"));

var __rest = this && this.__rest || function (s, e) {
  var t = {};

  for (var p in s) {
    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];
  }

  if (s != null && typeof Object.getOwnPropertySymbols === "function") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];
  }
  return t;
};

var avatarSizes = {
  small: 34,
  medium: 50,
  large: 75,
  xlarge: 150
};

var AvatarComponent = function AvatarComponent(_a) {
  var onPress = _a.onPress,
      onLongPress = _a.onLongPress,
      _a$Component = _a.Component,
      Component = _a$Component === void 0 ? onPress || onLongPress ? _reactNative.TouchableOpacity : _reactNative.View : _a$Component,
      containerStyle = _a.containerStyle,
      icon = _a.icon,
      iconStyle = _a.iconStyle,
      source = _a.source,
      _a$size = _a.size,
      size = _a$size === void 0 ? 'small' : _a$size,
      avatarStyle = _a.avatarStyle,
      rounded = _a.rounded,
      title = _a.title,
      titleStyle = _a.titleStyle,
      overlayContainerStyle = _a.overlayContainerStyle,
      imageProps = _a.imageProps,
      placeholderStyle = _a.placeholderStyle,
      renderPlaceholderContent = _a.renderPlaceholderContent,
      _a$ImageComponent = _a.ImageComponent,
      ImageComponent = _a$ImageComponent === void 0 ? _reactNative.Image : _a$ImageComponent,
      children = _a.children,
      attributes = __rest(_a, ["onPress", "onLongPress", "Component", "containerStyle", "icon", "iconStyle", "source", "size", "avatarStyle", "rounded", "title", "titleStyle", "overlayContainerStyle", "imageProps", "placeholderStyle", "renderPlaceholderContent", "ImageComponent", "children"]);

  var width = typeof size === 'number' ? size : avatarSizes[size] || avatarSizes.small;
  var height = width;
  var titleSize = width / 2;
  var iconSize = width / 2;

  var PlaceholderContent = renderPlaceholderContent && (0, _helpers.renderNode)(undefined, renderPlaceholderContent) || title && _react.default.createElement(_reactNative.Text, {
    style: _reactNative.StyleSheet.flatten([styles.title, {
      fontSize: titleSize
    }, titleStyle])
  }, title) || icon && _react.default.createElement(_Icon.default, {
    style: iconStyle && iconStyle,
    color: icon.color || 'white',
    name: icon.name || 'user',
    size: icon.size || iconSize,
    type: icon.type && icon.type
  });

  var hidePlaceholder = !(source && source.uri);

  var imageContainerStyle = _reactNative.StyleSheet.flatten([styles.overlayContainer, rounded && {
    borderRadius: width / 2,
    overflow: 'hidden'
  }, overlayContainerStyle, imageProps && imageProps.containerStyle]);

  if (imageProps && imageProps.containerStyle) {
    delete imageProps.containerStyle;
  }

  return _react.default.createElement(Component, (0, _extends2.default)({
    onPress: onPress,
    onLongPress: onLongPress,
    style: _reactNative.StyleSheet.flatten([styles.container, {
      height: height,
      width: width
    }, rounded && {
      borderRadius: width / 2
    }, containerStyle])
  }, attributes), _react.default.createElement(_Image.default, (0, _extends2.default)({
    placeholderStyle: _reactNative.StyleSheet.flatten([placeholderStyle, hidePlaceholder && styles.hiddenPlaceholderStyle]),
    PlaceholderContent: PlaceholderContent,
    containerStyle: imageContainerStyle,
    source: source,
    borderRadius: rounded ? width / 2 : undefined
  }, imageProps, {
    style: _reactNative.StyleSheet.flatten([styles.avatar, imageProps && imageProps.style, avatarStyle]),
    ImageComponent: ImageComponent
  })), children);
};

var styles = _reactNative.StyleSheet.create({
  container: {
    backgroundColor: 'transparent'
  },
  avatar: {
    flex: 1,
    width: undefined,
    height: undefined
  },
  overlayContainer: {
    flex: 1
  },
  title: {
    color: '#ffffff',
    backgroundColor: 'transparent',
    textAlign: 'center'
  },
  hiddenPlaceholderStyle: {
    backgroundColor: 'transparent'
  }
});

var Avatar = _react.default.memo(AvatarComponent, _lodash.default);

exports.Avatar = Avatar;
var ThemedAvatar = Object.assign((0, _config.withTheme)(Avatar, 'Avatar'), {
  Accessory: _Accessory.default
});
var _default = ThemedAvatar;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF2YXRhci5qcyJdLCJuYW1lcyI6WyJfX3Jlc3QiLCJzIiwiZSIsInQiLCJwIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaW5kZXhPZiIsImdldE93blByb3BlcnR5U3ltYm9scyIsImkiLCJsZW5ndGgiLCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsImF2YXRhclNpemVzIiwic21hbGwiLCJtZWRpdW0iLCJsYXJnZSIsInhsYXJnZSIsIkF2YXRhckNvbXBvbmVudCIsIl9hIiwib25QcmVzcyIsIm9uTG9uZ1ByZXNzIiwiQ29tcG9uZW50IiwiVG91Y2hhYmxlT3BhY2l0eSIsIlZpZXciLCJjb250YWluZXJTdHlsZSIsImljb24iLCJpY29uU3R5bGUiLCJzb3VyY2UiLCJzaXplIiwiYXZhdGFyU3R5bGUiLCJyb3VuZGVkIiwidGl0bGUiLCJ0aXRsZVN0eWxlIiwib3ZlcmxheUNvbnRhaW5lclN0eWxlIiwiaW1hZ2VQcm9wcyIsInBsYWNlaG9sZGVyU3R5bGUiLCJyZW5kZXJQbGFjZWhvbGRlckNvbnRlbnQiLCJJbWFnZUNvbXBvbmVudCIsIlJOSW1hZ2UiLCJjaGlsZHJlbiIsImF0dHJpYnV0ZXMiLCJ3aWR0aCIsImhlaWdodCIsInRpdGxlU2l6ZSIsImljb25TaXplIiwiUGxhY2Vob2xkZXJDb250ZW50IiwidW5kZWZpbmVkIiwiU3R5bGVTaGVldCIsImZsYXR0ZW4iLCJzdHlsZXMiLCJmb250U2l6ZSIsImNvbG9yIiwibmFtZSIsInR5cGUiLCJoaWRlUGxhY2Vob2xkZXIiLCJ1cmkiLCJpbWFnZUNvbnRhaW5lclN0eWxlIiwib3ZlcmxheUNvbnRhaW5lciIsImJvcmRlclJhZGl1cyIsIm92ZXJmbG93IiwiY29udGFpbmVyIiwiaGlkZGVuUGxhY2Vob2xkZXJTdHlsZSIsImF2YXRhciIsInN0eWxlIiwiY3JlYXRlIiwiYmFja2dyb3VuZENvbG9yIiwiZmxleCIsInRleHRBbGlnbiIsIkF2YXRhciIsIlJlYWN0IiwibWVtbyIsImlzRXF1YWwiLCJUaGVtZWRBdmF0YXIiLCJhc3NpZ24iLCJBY2Nlc3NvcnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQVdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQWxCQSxJQUFJQSxNQUFNLEdBQUksUUFBUSxLQUFLQSxNQUFkLElBQXlCLFVBQVVDLENBQVYsRUFBYUMsQ0FBYixFQUFnQjtBQUNsRCxNQUFJQyxDQUFDLEdBQUcsRUFBUjs7QUFDQSxPQUFLLElBQUlDLENBQVQsSUFBY0gsQ0FBZDtBQUFpQixRQUFJSSxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLGNBQWpCLENBQWdDQyxJQUFoQyxDQUFxQ1AsQ0FBckMsRUFBd0NHLENBQXhDLEtBQThDRixDQUFDLENBQUNPLE9BQUYsQ0FBVUwsQ0FBVixJQUFlLENBQWpFLEVBQ2JELENBQUMsQ0FBQ0MsQ0FBRCxDQUFELEdBQU9ILENBQUMsQ0FBQ0csQ0FBRCxDQUFSO0FBREo7O0FBRUEsTUFBSUgsQ0FBQyxJQUFJLElBQUwsSUFBYSxPQUFPSSxNQUFNLENBQUNLLHFCQUFkLEtBQXdDLFVBQXpELEVBQ0ksS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBUixFQUFXUCxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0sscUJBQVAsQ0FBNkJULENBQTdCLENBQXBCLEVBQXFEVSxDQUFDLEdBQUdQLENBQUMsQ0FBQ1EsTUFBM0QsRUFBbUVELENBQUMsRUFBcEUsRUFBd0U7QUFDcEUsUUFBSVQsQ0FBQyxDQUFDTyxPQUFGLENBQVVMLENBQUMsQ0FBQ08sQ0FBRCxDQUFYLElBQWtCLENBQWxCLElBQXVCTixNQUFNLENBQUNDLFNBQVAsQ0FBaUJPLG9CQUFqQixDQUFzQ0wsSUFBdEMsQ0FBMkNQLENBQTNDLEVBQThDRyxDQUFDLENBQUNPLENBQUQsQ0FBL0MsQ0FBM0IsRUFDSVIsQ0FBQyxDQUFDQyxDQUFDLENBQUNPLENBQUQsQ0FBRixDQUFELEdBQVVWLENBQUMsQ0FBQ0csQ0FBQyxDQUFDTyxDQUFELENBQUYsQ0FBWDtBQUNQO0FBQ0wsU0FBT1IsQ0FBUDtBQUNILENBVkQ7O0FBbUJBLElBQU1XLFdBQVcsR0FBRztBQUNoQkMsRUFBQUEsS0FBSyxFQUFFLEVBRFM7QUFFaEJDLEVBQUFBLE1BQU0sRUFBRSxFQUZRO0FBR2hCQyxFQUFBQSxLQUFLLEVBQUUsRUFIUztBQUloQkMsRUFBQUEsTUFBTSxFQUFFO0FBSlEsQ0FBcEI7O0FBTUEsSUFBTUMsZUFBZSxHQUFHLFNBQWxCQSxlQUFrQixDQUFDQyxFQUFELEVBQVE7QUFBQSxNQUN0QkMsT0FEc0IsR0FDc1JELEVBRHRSLENBQ3RCQyxPQURzQjtBQUFBLE1BQ2JDLFdBRGEsR0FDc1JGLEVBRHRSLENBQ2JFLFdBRGE7QUFBQSxxQkFDc1JGLEVBRHRSLENBQ0FHLFNBREE7QUFBQSxNQUNBQSxTQURBLDZCQUNZRixPQUFPLElBQUlDLFdBQVgsR0FBeUJFLDZCQUF6QixHQUE0Q0MsaUJBRHhEO0FBQUEsTUFDOERDLGNBRDlELEdBQ3NSTixFQUR0UixDQUM4RE0sY0FEOUQ7QUFBQSxNQUM4RUMsSUFEOUUsR0FDc1JQLEVBRHRSLENBQzhFTyxJQUQ5RTtBQUFBLE1BQ29GQyxTQURwRixHQUNzUlIsRUFEdFIsQ0FDb0ZRLFNBRHBGO0FBQUEsTUFDK0ZDLE1BRC9GLEdBQ3NSVCxFQUR0UixDQUMrRlMsTUFEL0Y7QUFBQSxnQkFDc1JULEVBRHRSLENBQ3VHVSxJQUR2RztBQUFBLE1BQ3VHQSxJQUR2Ryx3QkFDOEcsT0FEOUc7QUFBQSxNQUN1SEMsV0FEdkgsR0FDc1JYLEVBRHRSLENBQ3VIVyxXQUR2SDtBQUFBLE1BQ29JQyxPQURwSSxHQUNzUlosRUFEdFIsQ0FDb0lZLE9BRHBJO0FBQUEsTUFDNklDLEtBRDdJLEdBQ3NSYixFQUR0UixDQUM2SWEsS0FEN0k7QUFBQSxNQUNvSkMsVUFEcEosR0FDc1JkLEVBRHRSLENBQ29KYyxVQURwSjtBQUFBLE1BQ2dLQyxxQkFEaEssR0FDc1JmLEVBRHRSLENBQ2dLZSxxQkFEaEs7QUFBQSxNQUN1TEMsVUFEdkwsR0FDc1JoQixFQUR0UixDQUN1TGdCLFVBRHZMO0FBQUEsTUFDbU1DLGdCQURuTSxHQUNzUmpCLEVBRHRSLENBQ21NaUIsZ0JBRG5NO0FBQUEsTUFDcU5DLHdCQURyTixHQUNzUmxCLEVBRHRSLENBQ3FOa0Isd0JBRHJOO0FBQUEsMEJBQ3NSbEIsRUFEdFIsQ0FDK09tQixjQUQvTztBQUFBLE1BQytPQSxjQUQvTyxrQ0FDZ1FDLGtCQURoUTtBQUFBLE1BQ3lRQyxRQUR6USxHQUNzUnJCLEVBRHRSLENBQ3lRcUIsUUFEelE7QUFBQSxNQUMwUkMsVUFEMVIsR0FDdVMxQyxNQUFNLENBQUNvQixFQUFELEVBQUssQ0FBQyxTQUFELEVBQVksYUFBWixFQUEyQixXQUEzQixFQUF3QyxnQkFBeEMsRUFBMEQsTUFBMUQsRUFBa0UsV0FBbEUsRUFBK0UsUUFBL0UsRUFBeUYsTUFBekYsRUFBaUcsYUFBakcsRUFBZ0gsU0FBaEgsRUFBMkgsT0FBM0gsRUFBb0ksWUFBcEksRUFBa0osdUJBQWxKLEVBQTJLLFlBQTNLLEVBQXlMLGtCQUF6TCxFQUE2TSwwQkFBN00sRUFBeU8sZ0JBQXpPLEVBQTJQLFVBQTNQLENBQUwsQ0FEN1M7O0FBRTVCLE1BQU11QixLQUFLLEdBQUcsT0FBT2IsSUFBUCxLQUFnQixRQUFoQixHQUEyQkEsSUFBM0IsR0FBa0NoQixXQUFXLENBQUNnQixJQUFELENBQVgsSUFBcUJoQixXQUFXLENBQUNDLEtBQWpGO0FBQ0EsTUFBTTZCLE1BQU0sR0FBR0QsS0FBZjtBQUNBLE1BQU1FLFNBQVMsR0FBR0YsS0FBSyxHQUFHLENBQTFCO0FBQ0EsTUFBTUcsUUFBUSxHQUFHSCxLQUFLLEdBQUcsQ0FBekI7O0FBQ0EsTUFBTUksa0JBQWtCLEdBQUlULHdCQUF3QixJQUNoRCx5QkFBV1UsU0FBWCxFQUFzQlYsd0JBQXRCLENBRHVCLElBRXRCTCxLQUFLLElBQUssNkJBQUMsaUJBQUQ7QUFBTSxJQUFBLEtBQUssRUFBRWdCLHdCQUFXQyxPQUFYLENBQW1CLENBQ3ZDQyxNQUFNLENBQUNsQixLQURnQyxFQUV2QztBQUFFbUIsTUFBQUEsUUFBUSxFQUFFUDtBQUFaLEtBRnVDLEVBR3ZDWCxVQUh1QyxDQUFuQjtBQUFiLEtBS1ZELEtBTFUsQ0FGWSxJQVN0Qk4sSUFBSSxJQUFLLDZCQUFDLGFBQUQ7QUFFVixJQUFBLEtBQUssRUFBRUMsU0FBUyxJQUFJQSxTQUZWO0FBRXFCLElBQUEsS0FBSyxFQUFFRCxJQUFJLENBQUMwQixLQUFMLElBQWMsT0FGMUM7QUFFbUQsSUFBQSxJQUFJLEVBQUUxQixJQUFJLENBQUMyQixJQUFMLElBQWEsTUFGdEU7QUFFOEUsSUFBQSxJQUFJLEVBQUUzQixJQUFJLENBQUNHLElBQUwsSUFBYWdCLFFBRmpHO0FBRTJHLElBQUEsSUFBSSxFQUFFbkIsSUFBSSxDQUFDNEIsSUFBTCxJQUFhNUIsSUFBSSxDQUFDNEI7QUFGbkksSUFUZDs7QUFhQSxNQUFNQyxlQUFlLEdBQUcsRUFBRTNCLE1BQU0sSUFBSUEsTUFBTSxDQUFDNEIsR0FBbkIsQ0FBeEI7O0FBRUEsTUFBTUMsbUJBQW1CLEdBQUdULHdCQUFXQyxPQUFYLENBQW1CLENBQzNDQyxNQUFNLENBQUNRLGdCQURvQyxFQUUzQzNCLE9BQU8sSUFBSTtBQUFFNEIsSUFBQUEsWUFBWSxFQUFFakIsS0FBSyxHQUFHLENBQXhCO0FBQTJCa0IsSUFBQUEsUUFBUSxFQUFFO0FBQXJDLEdBRmdDLEVBRzNDMUIscUJBSDJDLEVBSTNDQyxVQUFVLElBQUlBLFVBQVUsQ0FBQ1YsY0FKa0IsQ0FBbkIsQ0FBNUI7O0FBTUEsTUFBSVUsVUFBVSxJQUFJQSxVQUFVLENBQUNWLGNBQTdCLEVBQTZDO0FBQ3pDLFdBQU9VLFVBQVUsQ0FBQ1YsY0FBbEI7QUFDSDs7QUFDRCxTQUFRLDZCQUFDLFNBQUQ7QUFBVyxJQUFBLE9BQU8sRUFBRUwsT0FBcEI7QUFBNkIsSUFBQSxXQUFXLEVBQUVDLFdBQTFDO0FBQXVELElBQUEsS0FBSyxFQUFFMkIsd0JBQVdDLE9BQVgsQ0FBbUIsQ0FDckZDLE1BQU0sQ0FBQ1csU0FEOEUsRUFFckY7QUFBRWxCLE1BQUFBLE1BQU0sRUFBTkEsTUFBRjtBQUFVRCxNQUFBQSxLQUFLLEVBQUxBO0FBQVYsS0FGcUYsRUFHckZYLE9BQU8sSUFBSTtBQUFFNEIsTUFBQUEsWUFBWSxFQUFFakIsS0FBSyxHQUFHO0FBQXhCLEtBSDBFLEVBSXJGakIsY0FKcUYsQ0FBbkI7QUFBOUQsS0FLQWdCLFVBTEEsR0FNTiw2QkFBQyxjQUFEO0FBQU8sSUFBQSxnQkFBZ0IsRUFBRU8sd0JBQVdDLE9BQVgsQ0FBbUIsQ0FDMUNiLGdCQUQwQyxFQUUxQ21CLGVBQWUsSUFBSUwsTUFBTSxDQUFDWSxzQkFGZ0IsQ0FBbkIsQ0FBekI7QUFHRSxJQUFBLGtCQUFrQixFQUFFaEIsa0JBSHRCO0FBS0YsSUFBQSxjQUFjLEVBQUVXLG1CQUxkO0FBS21DLElBQUEsTUFBTSxFQUFFN0IsTUFMM0M7QUFLbUQsSUFBQSxZQUFZLEVBQUVHLE9BQU8sR0FBR1csS0FBSyxHQUFHLENBQVgsR0FBZUs7QUFMdkYsS0FLc0daLFVBTHRHO0FBS2tILElBQUEsS0FBSyxFQUFFYSx3QkFBV0MsT0FBWCxDQUFtQixDQUMxSUMsTUFBTSxDQUFDYSxNQURtSSxFQUUxSTVCLFVBQVUsSUFBSUEsVUFBVSxDQUFDNkIsS0FGaUgsRUFHMUlsQyxXQUgwSSxDQUFuQixDQUx6SDtBQVNFLElBQUEsY0FBYyxFQUFFUTtBQVRsQixLQU5NLEVBZ0JMRSxRQWhCSyxDQUFSO0FBa0JILENBaEREOztBQWlEQSxJQUFNVSxNQUFNLEdBQUdGLHdCQUFXaUIsTUFBWCxDQUFrQjtBQUM3QkosRUFBQUEsU0FBUyxFQUFFO0FBQ1BLLElBQUFBLGVBQWUsRUFBRTtBQURWLEdBRGtCO0FBSTdCSCxFQUFBQSxNQUFNLEVBQUU7QUFDSkksSUFBQUEsSUFBSSxFQUFFLENBREY7QUFFSnpCLElBQUFBLEtBQUssRUFBRUssU0FGSDtBQUdKSixJQUFBQSxNQUFNLEVBQUVJO0FBSEosR0FKcUI7QUFTN0JXLEVBQUFBLGdCQUFnQixFQUFFO0FBQ2RTLElBQUFBLElBQUksRUFBRTtBQURRLEdBVFc7QUFZN0JuQyxFQUFBQSxLQUFLLEVBQUU7QUFDSG9CLElBQUFBLEtBQUssRUFBRSxTQURKO0FBRUhjLElBQUFBLGVBQWUsRUFBRSxhQUZkO0FBR0hFLElBQUFBLFNBQVMsRUFBRTtBQUhSLEdBWnNCO0FBaUI3Qk4sRUFBQUEsc0JBQXNCLEVBQUU7QUFDcEJJLElBQUFBLGVBQWUsRUFBRTtBQURHO0FBakJLLENBQWxCLENBQWY7O0FBcUJBLElBQU1HLE1BQU0sR0FBR0MsZUFBTUMsSUFBTixDQUFXckQsZUFBWCxFQUE0QnNELGVBQTVCLENBQWY7OztBQUVBLElBQU1DLFlBQVksR0FBR3JFLE1BQU0sQ0FBQ3NFLE1BQVAsQ0FBYyx1QkFBVUwsTUFBVixFQUFrQixRQUFsQixDQUFkLEVBQTJDO0FBQzVETSxFQUFBQSxTQUFTLEVBQUVBO0FBRGlELENBQTNDLENBQXJCO2VBR2VGLFkiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19yZXN0ID0gKHRoaXMgJiYgdGhpcy5fX3Jlc3QpIHx8IGZ1bmN0aW9uIChzLCBlKSB7XG4gICAgdmFyIHQgPSB7fTtcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcbiAgICAgICAgdFtwXSA9IHNbcF07XG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XG4gICAgICAgIH1cbiAgICByZXR1cm4gdDtcbn07XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVmlldywgVGV4dCwgSW1hZ2UgYXMgUk5JbWFnZSwgU3R5bGVTaGVldCwgVG91Y2hhYmxlT3BhY2l0eSwgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSAnbG9kYXNoLmlzZXF1YWwnO1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCB7IHJlbmRlck5vZGUgfSBmcm9tICcuLi9oZWxwZXJzJztcbmltcG9ydCBJY29uIGZyb20gJy4uL2ljb25zL0ljb24nO1xuaW1wb3J0IEltYWdlIGZyb20gJy4uL2ltYWdlL0ltYWdlJztcbmltcG9ydCBBY2Nlc3NvcnkgZnJvbSAnLi9BY2Nlc3NvcnknO1xuY29uc3QgYXZhdGFyU2l6ZXMgPSB7XG4gICAgc21hbGw6IDM0LFxuICAgIG1lZGl1bTogNTAsXG4gICAgbGFyZ2U6IDc1LFxuICAgIHhsYXJnZTogMTUwLFxufTtcbmNvbnN0IEF2YXRhckNvbXBvbmVudCA9IChfYSkgPT4ge1xuICAgIHZhciB7IG9uUHJlc3MsIG9uTG9uZ1ByZXNzLCBDb21wb25lbnQgPSBvblByZXNzIHx8IG9uTG9uZ1ByZXNzID8gVG91Y2hhYmxlT3BhY2l0eSA6IFZpZXcsIGNvbnRhaW5lclN0eWxlLCBpY29uLCBpY29uU3R5bGUsIHNvdXJjZSwgc2l6ZSA9ICdzbWFsbCcsIGF2YXRhclN0eWxlLCByb3VuZGVkLCB0aXRsZSwgdGl0bGVTdHlsZSwgb3ZlcmxheUNvbnRhaW5lclN0eWxlLCBpbWFnZVByb3BzLCBwbGFjZWhvbGRlclN0eWxlLCByZW5kZXJQbGFjZWhvbGRlckNvbnRlbnQsIEltYWdlQ29tcG9uZW50ID0gUk5JbWFnZSwgY2hpbGRyZW4gfSA9IF9hLCBhdHRyaWJ1dGVzID0gX19yZXN0KF9hLCBbXCJvblByZXNzXCIsIFwib25Mb25nUHJlc3NcIiwgXCJDb21wb25lbnRcIiwgXCJjb250YWluZXJTdHlsZVwiLCBcImljb25cIiwgXCJpY29uU3R5bGVcIiwgXCJzb3VyY2VcIiwgXCJzaXplXCIsIFwiYXZhdGFyU3R5bGVcIiwgXCJyb3VuZGVkXCIsIFwidGl0bGVcIiwgXCJ0aXRsZVN0eWxlXCIsIFwib3ZlcmxheUNvbnRhaW5lclN0eWxlXCIsIFwiaW1hZ2VQcm9wc1wiLCBcInBsYWNlaG9sZGVyU3R5bGVcIiwgXCJyZW5kZXJQbGFjZWhvbGRlckNvbnRlbnRcIiwgXCJJbWFnZUNvbXBvbmVudFwiLCBcImNoaWxkcmVuXCJdKTtcbiAgICBjb25zdCB3aWR0aCA9IHR5cGVvZiBzaXplID09PSAnbnVtYmVyJyA/IHNpemUgOiBhdmF0YXJTaXplc1tzaXplXSB8fCBhdmF0YXJTaXplcy5zbWFsbDtcbiAgICBjb25zdCBoZWlnaHQgPSB3aWR0aDtcbiAgICBjb25zdCB0aXRsZVNpemUgPSB3aWR0aCAvIDI7XG4gICAgY29uc3QgaWNvblNpemUgPSB3aWR0aCAvIDI7XG4gICAgY29uc3QgUGxhY2Vob2xkZXJDb250ZW50ID0gKHJlbmRlclBsYWNlaG9sZGVyQ29udGVudCAmJlxuICAgICAgICByZW5kZXJOb2RlKHVuZGVmaW5lZCwgcmVuZGVyUGxhY2Vob2xkZXJDb250ZW50KSkgfHxcbiAgICAgICAgKHRpdGxlICYmICg8VGV4dCBzdHlsZT17U3R5bGVTaGVldC5mbGF0dGVuKFtcbiAgICAgICAgICAgIHN0eWxlcy50aXRsZSxcbiAgICAgICAgICAgIHsgZm9udFNpemU6IHRpdGxlU2l6ZSB9LFxuICAgICAgICAgICAgdGl0bGVTdHlsZSxcbiAgICAgICAgXSl9PlxuICAgICAgICB7dGl0bGV9XG4gICAgICA8L1RleHQ+KSkgfHxcbiAgICAgICAgKGljb24gJiYgKDxJY29uIFxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgc3R5bGU9e2ljb25TdHlsZSAmJiBpY29uU3R5bGV9IGNvbG9yPXtpY29uLmNvbG9yIHx8ICd3aGl0ZSd9IG5hbWU9e2ljb24ubmFtZSB8fCAndXNlcid9IHNpemU9e2ljb24uc2l6ZSB8fCBpY29uU2l6ZX0gdHlwZT17aWNvbi50eXBlICYmIGljb24udHlwZX0vPikpO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBoaWRlUGxhY2Vob2xkZXIgPSAhKHNvdXJjZSAmJiBzb3VyY2UudXJpKTtcbiAgICAvLyBNZXJnZSBpbWFnZSBjb250YWluZXIgc3R5bGVcbiAgICBjb25zdCBpbWFnZUNvbnRhaW5lclN0eWxlID0gU3R5bGVTaGVldC5mbGF0dGVuKFtcbiAgICAgICAgc3R5bGVzLm92ZXJsYXlDb250YWluZXIsXG4gICAgICAgIHJvdW5kZWQgJiYgeyBib3JkZXJSYWRpdXM6IHdpZHRoIC8gMiwgb3ZlcmZsb3c6ICdoaWRkZW4nIH0sXG4gICAgICAgIG92ZXJsYXlDb250YWluZXJTdHlsZSxcbiAgICAgICAgaW1hZ2VQcm9wcyAmJiBpbWFnZVByb3BzLmNvbnRhaW5lclN0eWxlLFxuICAgIF0pO1xuICAgIGlmIChpbWFnZVByb3BzICYmIGltYWdlUHJvcHMuY29udGFpbmVyU3R5bGUpIHtcbiAgICAgICAgZGVsZXRlIGltYWdlUHJvcHMuY29udGFpbmVyU3R5bGU7XG4gICAgfVxuICAgIHJldHVybiAoPENvbXBvbmVudCBvblByZXNzPXtvblByZXNzfSBvbkxvbmdQcmVzcz17b25Mb25nUHJlc3N9IHN0eWxlPXtTdHlsZVNoZWV0LmZsYXR0ZW4oW1xuICAgICAgICBzdHlsZXMuY29udGFpbmVyLFxuICAgICAgICB7IGhlaWdodCwgd2lkdGggfSxcbiAgICAgICAgcm91bmRlZCAmJiB7IGJvcmRlclJhZGl1czogd2lkdGggLyAyIH0sXG4gICAgICAgIGNvbnRhaW5lclN0eWxlLFxuICAgIF0pfSB7Li4uYXR0cmlidXRlc30+XG4gICAgICA8SW1hZ2UgcGxhY2Vob2xkZXJTdHlsZT17U3R5bGVTaGVldC5mbGF0dGVuKFtcbiAgICAgICAgcGxhY2Vob2xkZXJTdHlsZSxcbiAgICAgICAgaGlkZVBsYWNlaG9sZGVyICYmIHN0eWxlcy5oaWRkZW5QbGFjZWhvbGRlclN0eWxlLFxuICAgIF0pfSBQbGFjZWhvbGRlckNvbnRlbnQ9e1BsYWNlaG9sZGVyQ29udGVudH0gXG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29udGFpbmVyU3R5bGU9e2ltYWdlQ29udGFpbmVyU3R5bGV9IHNvdXJjZT17c291cmNlfSBib3JkZXJSYWRpdXM9e3JvdW5kZWQgPyB3aWR0aCAvIDIgOiB1bmRlZmluZWR9IHsuLi5pbWFnZVByb3BzfSBzdHlsZT17U3R5bGVTaGVldC5mbGF0dGVuKFtcbiAgICAgICAgc3R5bGVzLmF2YXRhcixcbiAgICAgICAgaW1hZ2VQcm9wcyAmJiBpbWFnZVByb3BzLnN0eWxlLFxuICAgICAgICBhdmF0YXJTdHlsZSxcbiAgICBdKX0gSW1hZ2VDb21wb25lbnQ9e0ltYWdlQ29tcG9uZW50fS8+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9Db21wb25lbnQ+KTtcbn07XG5jb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7XG4gICAgY29udGFpbmVyOiB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICB9LFxuICAgIGF2YXRhcjoge1xuICAgICAgICBmbGV4OiAxLFxuICAgICAgICB3aWR0aDogdW5kZWZpbmVkLFxuICAgICAgICBoZWlnaHQ6IHVuZGVmaW5lZCxcbiAgICB9LFxuICAgIG92ZXJsYXlDb250YWluZXI6IHtcbiAgICAgICAgZmxleDogMSxcbiAgICB9LFxuICAgIHRpdGxlOiB7XG4gICAgICAgIGNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJyxcbiAgICB9LFxuICAgIGhpZGRlblBsYWNlaG9sZGVyU3R5bGU6IHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxuICAgIH0sXG59KTtcbmNvbnN0IEF2YXRhciA9IFJlYWN0Lm1lbW8oQXZhdGFyQ29tcG9uZW50LCBpc0VxdWFsKTtcbmV4cG9ydCB7IEF2YXRhciB9O1xuY29uc3QgVGhlbWVkQXZhdGFyID0gT2JqZWN0LmFzc2lnbih3aXRoVGhlbWUoQXZhdGFyLCAnQXZhdGFyJyksIHtcbiAgICBBY2Nlc3Nvcnk6IEFjY2Vzc29yeSxcbn0pO1xuZXhwb3J0IGRlZmF1bHQgVGhlbWVkQXZhdGFyO1xuIl19