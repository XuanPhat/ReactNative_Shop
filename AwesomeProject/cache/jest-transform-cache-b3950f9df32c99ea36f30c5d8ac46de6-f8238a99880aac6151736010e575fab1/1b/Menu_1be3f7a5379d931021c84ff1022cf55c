4efae5e105a8f3d98ccb6e833591eaa7
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

var _regenerator = _interopRequireDefault2(require("@babel/runtime/regenerator"));

var _classCallCheck2 = _interopRequireDefault2(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault2(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault2(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault2(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault2(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault2(require("@babel/runtime/helpers/getPrototypeOf"));

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _theming = require("../../core/theming");

var _Portal = _interopRequireDefault(require("../Portal/Portal"));

var _Surface = _interopRequireDefault(require("../Surface"));

var _MenuItem2 = _interopRequireDefault(require("./MenuItem"));

var _constants = require("../../constants");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var SCREEN_INDENT = 8;
var ANIMATION_DURATION = 250;

var EASING = _reactNative.Easing.bezier(0.4, 0, 0.2, 1);

var Menu = function (_React$Component) {
  (0, _inherits2.default)(Menu, _React$Component);

  var _super = _createSuper(Menu);

  function Menu() {
    var _this;

    (0, _classCallCheck2.default)(this, Menu);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));

    _defineProperty((0, _assertThisInitialized2.default)(_this), "state", {
      rendered: _this.props.visible,
      top: 0,
      left: 0,
      menuLayout: {
        width: 0,
        height: 0
      },
      anchorLayout: {
        width: 0,
        height: 0
      },
      opacityAnimation: new _reactNative.Animated.Value(0),
      scaleAnimation: new _reactNative.Animated.ValueXY({
        x: 0,
        y: 0
      })
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "anchor", null);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "menu", null);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "isAnchorCoord", function () {
      return !React.isValidElement(_this.props.anchor);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "measureMenuLayout", function () {
      return new Promise(function (resolve) {
        if (_this.menu) {
          _this.menu.measureInWindow(function (x, y, width, height) {
            resolve({
              x: x,
              y: y,
              width: width,
              height: height
            });
          });
        }
      });
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "measureAnchorLayout", function () {
      return new Promise(function (resolve) {
        var anchor = _this.props.anchor;

        if (_this.isAnchorCoord()) {
          resolve({
            x: anchor.x,
            y: anchor.y,
            width: 0,
            height: 0
          });
          return;
        }

        if (_this.anchor) {
          _this.anchor.measureInWindow(function (x, y, width, height) {
            resolve({
              x: x,
              y: y,
              width: width,
              height: height
            });
          });
        }
      });
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "updateVisibility", function _callee() {
      return _regenerator.default.async(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regenerator.default.awrap(Promise.resolve());

            case 2:
              if (_this.props.visible) {
                _this.show();
              } else {
                _this.hide();
              }

            case 3:
            case "end":
              return _context.stop();
          }
        }
      }, null, null, null, Promise);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "isBrowser", function () {
      return _reactNative.Platform.OS === 'web' && 'document' in global;
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "focusFirstDOMNode", function (el) {
      if (el && _this.isBrowser()) {
        var node = (0, _reactNative.findNodeHandle)(el);
        var focusableNode = node.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
        focusableNode === null || focusableNode === void 0 ? void 0 : focusableNode.focus();
      }
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "handleDismiss", function () {
      if (_this.props.visible) {
        _this.props.onDismiss();
      }

      return true;
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "handleKeypress", function (e) {
      if (e.key === 'Escape') {
        _this.props.onDismiss();
      }
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "attachListeners", function () {
      _reactNative.BackHandler.addEventListener('hardwareBackPress', _this.handleDismiss);

      _reactNative.Dimensions.addEventListener('change', _this.handleDismiss);

      _this.isBrowser() && document.addEventListener('keyup', _this.handleKeypress);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "removeListeners", function () {
      _reactNative.BackHandler.removeEventListener('hardwareBackPress', _this.handleDismiss);

      _reactNative.Dimensions.removeEventListener('change', _this.handleDismiss);

      _this.isBrowser() && document.removeEventListener('keyup', _this.handleKeypress);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "show", function _callee2() {
      var windowLayout, _await$Promise$all, _await$Promise$all2, menuLayout, anchorLayout;

      return _regenerator.default.async(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              windowLayout = _reactNative.Dimensions.get('window');
              _context2.next = 3;
              return _regenerator.default.awrap(Promise.all([_this.measureMenuLayout(), _this.measureAnchorLayout()]));

            case 3:
              _await$Promise$all = _context2.sent;
              _await$Promise$all2 = (0, _slicedToArray2.default)(_await$Promise$all, 2);
              menuLayout = _await$Promise$all2[0];
              anchorLayout = _await$Promise$all2[1];

              if (!(!windowLayout.width || !windowLayout.height || !menuLayout.width || !menuLayout.height || !anchorLayout.width && !_this.isAnchorCoord() || !anchorLayout.height && !_this.isAnchorCoord())) {
                _context2.next = 10;
                break;
              }

              requestAnimationFrame(_this.show);
              return _context2.abrupt("return");

            case 10:
              _this.setState(function () {
                return {
                  left: anchorLayout.x,
                  top: anchorLayout.y,
                  anchorLayout: {
                    height: anchorLayout.height,
                    width: anchorLayout.width
                  },
                  menuLayout: {
                    width: menuLayout.width,
                    height: menuLayout.height
                  }
                };
              }, function () {
                _this.attachListeners();

                var animation = _this.props.theme.animation;

                _reactNative.Animated.parallel([_reactNative.Animated.timing(_this.state.scaleAnimation, {
                  toValue: {
                    x: menuLayout.width,
                    y: menuLayout.height
                  },
                  duration: ANIMATION_DURATION * animation.scale,
                  easing: EASING,
                  useNativeDriver: true
                }), _reactNative.Animated.timing(_this.state.opacityAnimation, {
                  toValue: 1,
                  duration: ANIMATION_DURATION * animation.scale,
                  easing: EASING,
                  useNativeDriver: true
                })]).start(function (_ref3) {
                  var finished = _ref3.finished;

                  if (finished) {
                    _this.focusFirstDOMNode(_this.menu);
                  }
                });
              });

            case 11:
            case "end":
              return _context2.stop();
          }
        }
      }, null, null, null, Promise);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "hide", function () {
      _this.removeListeners();

      var animation = _this.props.theme.animation;

      _reactNative.Animated.timing(_this.state.opacityAnimation, {
        toValue: 0,
        duration: ANIMATION_DURATION * animation.scale,
        easing: EASING,
        useNativeDriver: true
      }).start(function (_ref4) {
        var finished = _ref4.finished;

        if (finished) {
          _this.setState({
            menuLayout: {
              width: 0,
              height: 0
            },
            rendered: false
          });

          _this.state.scaleAnimation.setValue({
            x: 0,
            y: 0
          });

          _this.focusFirstDOMNode(_this.anchor);
        }
      });
    });

    return _this;
  }

  (0, _createClass2.default)(Menu, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      if (prevProps.visible !== this.props.visible) {
        this.updateVisibility();
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.removeListeners();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          visible = _this$props.visible,
          anchor = _this$props.anchor,
          contentStyle = _this$props.contentStyle,
          style = _this$props.style,
          children = _this$props.children,
          theme = _this$props.theme,
          statusBarHeight = _this$props.statusBarHeight,
          onDismiss = _this$props.onDismiss,
          overlayAccessibilityLabel = _this$props.overlayAccessibilityLabel;
      var _this$state = this.state,
          rendered = _this$state.rendered,
          menuLayout = _this$state.menuLayout,
          anchorLayout = _this$state.anchorLayout,
          opacityAnimation = _this$state.opacityAnimation,
          scaleAnimation = _this$state.scaleAnimation;
      var _this$state2 = this.state,
          left = _this$state2.left,
          top = _this$state2.top;

      var additionalVerticalValue = _reactNative.Platform.select({
        android: statusBarHeight,
        default: 0
      });

      var scaleTransforms = [{
        scaleX: scaleAnimation.x.interpolate({
          inputRange: [0, menuLayout.width],
          outputRange: [0, 1]
        })
      }, {
        scaleY: scaleAnimation.y.interpolate({
          inputRange: [0, menuLayout.height],
          outputRange: [0, 1]
        })
      }];

      var windowLayout = _reactNative.Dimensions.get('window');

      var positionTransforms = [];

      if (left <= windowLayout.width - menuLayout.width - SCREEN_INDENT) {
        positionTransforms.push({
          translateX: scaleAnimation.x.interpolate({
            inputRange: [0, menuLayout.width],
            outputRange: [-(menuLayout.width / 2), 0]
          })
        });

        if (left < SCREEN_INDENT) {
          left = SCREEN_INDENT;
        }
      } else {
        positionTransforms.push({
          translateX: scaleAnimation.x.interpolate({
            inputRange: [0, menuLayout.width],
            outputRange: [menuLayout.width / 2, 0]
          })
        });
        left += anchorLayout.width - menuLayout.width;
        var right = left + menuLayout.width;

        if (right > windowLayout.width - SCREEN_INDENT) {
          left = windowLayout.width - SCREEN_INDENT - menuLayout.width;
        }
      }

      var scrollableMenuHeight = 0;

      if (top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top <= windowLayout.height - top) {
        scrollableMenuHeight = windowLayout.height - top - SCREEN_INDENT - additionalVerticalValue;
      } else if (top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top >= windowLayout.height - top && top <= menuLayout.height - anchorLayout.height + SCREEN_INDENT - additionalVerticalValue) {
        scrollableMenuHeight = top + anchorLayout.height - SCREEN_INDENT + additionalVerticalValue;
      }

      scrollableMenuHeight = scrollableMenuHeight > windowLayout.height - 2 * SCREEN_INDENT ? windowLayout.height - 2 * SCREEN_INDENT : scrollableMenuHeight;

      if (top <= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue || top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top <= windowLayout.height - top) {
        positionTransforms.push({
          translateY: scaleAnimation.y.interpolate({
            inputRange: [0, menuLayout.height],
            outputRange: [-((scrollableMenuHeight || menuLayout.height) / 2), 0]
          })
        });

        if (top < SCREEN_INDENT) {
          top = SCREEN_INDENT;
        }
      } else {
        positionTransforms.push({
          translateY: scaleAnimation.y.interpolate({
            inputRange: [0, menuLayout.height],
            outputRange: [(scrollableMenuHeight || menuLayout.height) / 2, 0]
          })
        });
        top += anchorLayout.height - (scrollableMenuHeight || menuLayout.height);
        var bottom = top + (scrollableMenuHeight || menuLayout.height) + additionalVerticalValue;

        if (bottom > windowLayout.height - SCREEN_INDENT) {
          top = scrollableMenuHeight === windowLayout.height - 2 * SCREEN_INDENT ? -SCREEN_INDENT * 2 : windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue;
        }
      }

      var shadowMenuContainerStyle = _objectSpread({
        opacity: opacityAnimation,
        transform: scaleTransforms,
        borderRadius: theme.roundness
      }, scrollableMenuHeight ? {
        height: scrollableMenuHeight
      } : {});

      var positionStyle = _objectSpread({
        top: this.isAnchorCoord() ? top : top + additionalVerticalValue
      }, _reactNative.I18nManager.isRTL ? {
        right: left
      } : {
        left: left
      });

      return React.createElement(_reactNative.View, {
        ref: function ref(_ref2) {
          _this2.anchor = _ref2;
        },
        collapsable: false
      }, this.isAnchorCoord() ? null : anchor, rendered ? React.createElement(_Portal.default, null, React.createElement(_reactNative.TouchableWithoutFeedback, {
        accessibilityLabel: overlayAccessibilityLabel,
        accessibilityRole: "button",
        onPress: onDismiss
      }, React.createElement(_reactNative.View, {
        style: _reactNative.StyleSheet.absoluteFill
      })), React.createElement(_reactNative.View, {
        ref: function ref(_ref) {
          _this2.menu = _ref;
        },
        collapsable: false,
        accessibilityViewIsModal: visible,
        style: [styles.wrapper, positionStyle, style],
        pointerEvents: visible ? 'box-none' : 'none',
        onAccessibilityEscape: onDismiss
      }, React.createElement(_reactNative.Animated.View, {
        style: {
          transform: positionTransforms
        }
      }, React.createElement(_Surface.default, {
        style: [styles.shadowMenuContainer, shadowMenuContainerStyle, contentStyle]
      }, scrollableMenuHeight && React.createElement(_reactNative.ScrollView, null, children) || React.createElement(React.Fragment, null, children))))) : null);
    }
  }], [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(nextProps, prevState) {
      if (nextProps.visible && !prevState.rendered) {
        return {
          rendered: true
        };
      }

      return null;
    }
  }]);
  return Menu;
}(React.Component);

_defineProperty(Menu, "Item", _MenuItem2.default);

_defineProperty(Menu, "defaultProps", {
  statusBarHeight: _constants.APPROX_STATUSBAR_HEIGHT,
  overlayAccessibilityLabel: 'Close menu'
});

var styles = _reactNative.StyleSheet.create({
  wrapper: {
    position: 'absolute'
  },
  shadowMenuContainer: {
    opacity: 0,
    paddingVertical: 8,
    elevation: 8
  }
});

var _default = (0, _theming.withTheme)(Menu);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1lbnUudHN4Il0sIm5hbWVzIjpbIlNDUkVFTl9JTkRFTlQiLCJBTklNQVRJT05fRFVSQVRJT04iLCJFQVNJTkciLCJFYXNpbmciLCJNZW51IiwiUmVhY3QiLCJNZW51SXRlbSIsInN0YXR1c0JhckhlaWdodCIsIkFQUFJPWF9TVEFUVVNCQVJfSEVJR0hUIiwib3ZlcmxheUFjY2Vzc2liaWxpdHlMYWJlbCIsIm5leHRQcm9wcyIsInByZXZTdGF0ZSIsInJlbmRlcmVkIiwidG9wIiwibGVmdCIsIm1lbnVMYXlvdXQiLCJ3aWR0aCIsImhlaWdodCIsImFuY2hvckxheW91dCIsIm9wYWNpdHlBbmltYXRpb24iLCJBbmltYXRlZCIsInNjYWxlQW5pbWF0aW9uIiwieCIsInkiLCJwcmV2UHJvcHMiLCJyZXNvbHZlIiwiYW5jaG9yIiwiUHJvbWlzZSIsIlBsYXRmb3JtIiwiZWwiLCJub2RlIiwiZm9jdXNhYmxlTm9kZSIsImUiLCJCYWNrSGFuZGxlciIsIkRpbWVuc2lvbnMiLCJkb2N1bWVudCIsIndpbmRvd0xheW91dCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImFuaW1hdGlvbiIsInRvVmFsdWUiLCJkdXJhdGlvbiIsImVhc2luZyIsInVzZU5hdGl2ZURyaXZlciIsImZpbmlzaGVkIiwiYWRkaXRpb25hbFZlcnRpY2FsVmFsdWUiLCJhbmRyb2lkIiwiZGVmYXVsdCIsInNjYWxlVHJhbnNmb3JtcyIsInNjYWxlWCIsImlucHV0UmFuZ2UiLCJvdXRwdXRSYW5nZSIsInNjYWxlWSIsInBvc2l0aW9uVHJhbnNmb3JtcyIsInRyYW5zbGF0ZVgiLCJyaWdodCIsInNjcm9sbGFibGVNZW51SGVpZ2h0IiwidHJhbnNsYXRlWSIsImJvdHRvbSIsInNoYWRvd01lbnVDb250YWluZXJTdHlsZSIsIm9wYWNpdHkiLCJ0cmFuc2Zvcm0iLCJib3JkZXJSYWRpdXMiLCJ0aGVtZSIsInJvdW5kbmVzcyIsInBvc2l0aW9uU3R5bGUiLCJyZWYiLCJvbkRpc21pc3MiLCJTdHlsZVNoZWV0IiwiYWJzb2x1dGVGaWxsIiwic3R5bGVzIiwidmlzaWJsZSIsIndyYXBwZXIiLCJwb3NpdGlvbiIsInNoYWRvd01lbnVDb250YWluZXIiLCJwYWRkaW5nVmVydGljYWwiLCJlbGV2YXRpb24iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQSxLQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxZQUFBLEdBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQTs7QUFpQkEsSUFBQSxRQUFBLEdBQUEsT0FBQSxDQUFBLG9CQUFBLENBQUE7O0FBRUEsSUFBQSxPQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUVBLElBQUEsVUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsVUFBQSxHQUFBLE9BQUEsQ0FBQSxpQkFBQSxDQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0RBLElBQU1BLGFBQWEsR0FBbkIsQ0FBQTtBQUVBLElBQU1DLGtCQUFrQixHQUF4QixHQUFBOztBQUVBLElBQU1DLE1BQU0sR0FBR0MsWUFBQUEsQ0FBQUEsTUFBQUEsQ0FBQUEsTUFBQUEsQ0FBQUEsR0FBQUEsRUFBQUEsQ0FBQUEsRUFBQUEsR0FBQUEsRUFBZixDQUFlQSxDQUFmOztJQWdEQSxJOzs7OztBQUFpRCxrQkFBQTtBQUFBOztBQUFBOztBQUFBLHNDQUFBLElBQUE7QUFBQSxNQUFBLElBQUE7QUFBQTs7QUFBQSxvREFBQSxJQUFBOztBQUFBLElBQUEsZUFBQSw4Q0FBQSxPQUFBLEVBaUJ2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YkQsUyxFQUFBLFMsRUFBb0U7QUFDbEUsVUFBSTdDLFNBQVMsQ0FBVEEsT0FBQUEsSUFBcUIsQ0FBQ0MsU0FBUyxDQUFuQyxRQUFBLEVBQThDO0FBQzVDLGVBQU87QUFBRUMsVUFBQUEsUUFBUSxFQUFFO0FBQVosU0FBUDtBQUNEOztBQUVELGFBQUEsSUFBQTtBQUNEOzs7RUFmZ0JQLEtBQUssQ0FBeEIsUzs7Z0JBQU1ELEksVUFFVUUsVUFBQUEsQ0FBQUEsTzs7Z0JBRlZGLEksa0JBSWtCO0FBQ3BCRyxFQUFBQSxlQUFlLEVBQUVDLFVBQUFBLENBREcsdUJBQUE7QUFFcEJDLEVBQUFBLHlCQUF5QixFQUFFO0FBRlAsQzs7QUE0YnhCLElBQU00RCxNQUFNLEdBQUcsWUFBQSxDQUFBLFVBQUEsQ0FBQSxNQUFBLENBQWtCO0FBQy9CRSxFQUFBQSxPQUFPLEVBQUU7QUFDUEMsSUFBQUEsUUFBUSxFQUFFO0FBREgsR0FEc0I7QUFJL0JDLEVBQUFBLG1CQUFtQixFQUFFO0FBQ25CZCxJQUFBQSxPQUFPLEVBRFksQ0FBQTtBQUVuQmUsSUFBQUEsZUFBZSxFQUZJLENBQUE7QUFHbkJDLElBQUFBLFNBQVMsRUFBRTtBQUhRO0FBSlUsQ0FBbEIsQ0FBZjs7ZUFXZSxDQUFBLEdBQUEsUUFBQSxDQUFBLFNBQUEsRUFBQSxJQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBQbGF0Zm9ybSxcbiAgU3R5bGVQcm9wLFxuICBTdHlsZVNoZWV0LFxuICBBbmltYXRlZCxcbiAgQmFja0hhbmRsZXIsXG4gIERpbWVuc2lvbnMsXG4gIEVhc2luZyxcbiAgSTE4bk1hbmFnZXIsXG4gIExheW91dFJlY3RhbmdsZSxcbiAgVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrLFxuICBWaWV3LFxuICBWaWV3U3R5bGUsXG4gIFNjcm9sbFZpZXcsXG4gIGZpbmROb2RlSGFuZGxlLFxufSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuXG5pbXBvcnQgeyB3aXRoVGhlbWUgfSBmcm9tICcuLi8uLi9jb3JlL3RoZW1pbmcnO1xuaW1wb3J0IHR5cGUgeyAkT21pdCB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCBQb3J0YWwgZnJvbSAnLi4vUG9ydGFsL1BvcnRhbCc7XG5pbXBvcnQgU3VyZmFjZSBmcm9tICcuLi9TdXJmYWNlJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbmltcG9ydCBNZW51SXRlbSwgeyBNZW51SXRlbSBhcyBfTWVudUl0ZW0gfSBmcm9tICcuL01lbnVJdGVtJztcbmltcG9ydCB7IEFQUFJPWF9TVEFUVVNCQVJfSEVJR0hUIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzJztcblxudHlwZSBQcm9wcyA9IHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIE1lbnUgaXMgY3VycmVudGx5IHZpc2libGUuXG4gICAqL1xuICB2aXNpYmxlOiBib29sZWFuO1xuICAvKipcbiAgICogVGhlIGFuY2hvciB0byBvcGVuIHRoZSBtZW51IGZyb20uIEluIG1vc3QgY2FzZXMsIGl0IHdpbGwgYmUgYSBidXR0b24gdGhhdCBvcGVucyB0aGUgbWVudS5cbiAgICovXG4gIGFuY2hvcjogUmVhY3QuUmVhY3ROb2RlIHwgeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xuICAvKipcbiAgICogRXh0cmEgbWFyZ2luIHRvIGFkZCBhdCB0aGUgdG9wIG9mIHRoZSBtZW51IHRvIGFjY291bnQgZm9yIHRyYW5zbHVjZW50IHN0YXR1cyBiYXIgb24gQW5kcm9pZC5cbiAgICogSWYgeW91IGFyZSB1c2luZyBFeHBvLCB3ZSBhc3N1bWUgdHJhbnNsdWNlbnQgc3RhdHVzIGJhciBhbmQgc2V0IGEgaGVpZ2h0IGZvciBzdGF0dXMgYmFyIGF1dG9tYXRpY2FsbHkuXG4gICAqIFBhc3MgYDBgIG9yIGEgY3VzdG9tIHZhbHVlIHRvIGFuZCBjdXN0b21pemUgaXQuXG4gICAqIFRoaXMgaXMgYXV0b21hdGljYWxseSBoYW5kbGVkIG9uIGlPUy5cbiAgICovXG4gIHN0YXR1c0JhckhlaWdodD86IG51bWJlcjtcbiAgLyoqXG4gICAqIENhbGxiYWNrIGNhbGxlZCB3aGVuIE1lbnUgaXMgZGlzbWlzc2VkLiBUaGUgYHZpc2libGVgIHByb3AgbmVlZHMgdG8gYmUgdXBkYXRlZCB3aGVuIHRoaXMgaXMgY2FsbGVkLlxuICAgKi9cbiAgb25EaXNtaXNzOiAoKSA9PiB2b2lkO1xuICAvKipcbiAgICogQWNjZXNzaWJpbGl0eSBsYWJlbCBmb3IgdGhlIG92ZXJsYXkuIFRoaXMgaXMgcmVhZCBieSB0aGUgc2NyZWVuIHJlYWRlciB3aGVuIHRoZSB1c2VyIHRhcHMgb3V0c2lkZSB0aGUgbWVudS5cbiAgICovXG4gIG92ZXJsYXlBY2Nlc3NpYmlsaXR5TGFiZWw/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBDb250ZW50IG9mIHRoZSBgTWVudWAuXG4gICAqL1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlO1xuICAvKipcbiAgICogU3R5bGUgb2YgbWVudSdzIGlubmVyIGNvbnRlbnQuXG4gICAqL1xuICBjb250ZW50U3R5bGU/OiBTdHlsZVByb3A8Vmlld1N0eWxlPjtcbiAgc3R5bGU/OiBTdHlsZVByb3A8Vmlld1N0eWxlPjtcbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKi9cbiAgdGhlbWU6IFJlYWN0TmF0aXZlUGFwZXIuVGhlbWU7XG59O1xuXG50eXBlIExheW91dCA9ICRPbWl0PCRPbWl0PExheW91dFJlY3RhbmdsZSwgJ3gnPiwgJ3knPjtcblxudHlwZSBTdGF0ZSA9IHtcbiAgcmVuZGVyZWQ6IGJvb2xlYW47XG4gIHRvcDogbnVtYmVyO1xuICBsZWZ0OiBudW1iZXI7XG4gIG1lbnVMYXlvdXQ6IExheW91dDtcbiAgYW5jaG9yTGF5b3V0OiBMYXlvdXQ7XG4gIG9wYWNpdHlBbmltYXRpb246IEFuaW1hdGVkLlZhbHVlO1xuICBzY2FsZUFuaW1hdGlvbjogQW5pbWF0ZWQuVmFsdWVYWTtcbn07XG5cbi8vIE1pbmltdW0gcGFkZGluZyBiZXR3ZWVuIHRoZSBlZGdlIG9mIHRoZSBzY3JlZW4gYW5kIHRoZSBtZW51XG5jb25zdCBTQ1JFRU5fSU5ERU5UID0gODtcbi8vIEZyb20gaHR0cHM6Ly9tYXRlcmlhbC5pby9kZXNpZ24vbW90aW9uL3NwZWVkLmh0bWwjZHVyYXRpb25cbmNvbnN0IEFOSU1BVElPTl9EVVJBVElPTiA9IDI1MDtcbi8vIEZyb20gdGhlICdTdGFuZGFyZCBlYXNpbmcnIHNlY3Rpb24gb2YgaHR0cHM6Ly9tYXRlcmlhbC5pby9kZXNpZ24vbW90aW9uL3NwZWVkLmh0bWwjZWFzaW5nXG5jb25zdCBFQVNJTkcgPSBFYXNpbmcuYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTtcblxuLyoqXG4gKiBNZW51cyBkaXNwbGF5IGEgbGlzdCBvZiBjaG9pY2VzIG9uIHRlbXBvcmFyeSBlbGV2YXRlZCBzdXJmYWNlcy4gVGhlaXIgcGxhY2VtZW50IHZhcmllcyBiYXNlZCBvbiB0aGUgZWxlbWVudCB0aGF0IG9wZW5zIHRoZW0uXG4gKlxuICogIDxkaXYgY2xhc3M9XCJzY3JlZW5zaG90c1wiPlxuICogICA8aW1nIGNsYXNzPVwibWVkaXVtXCIgc3JjPVwic2NyZWVuc2hvdHMvbWVudS0xLnBuZ1wiIC8+XG4gKiAgIDxpbWcgY2xhc3M9XCJtZWRpdW1cIiBzcmM9XCJzY3JlZW5zaG90cy9tZW51LTIucG5nXCIgLz5cbiAqIDwvZGl2PlxuICpcbiAqICMjIFVzYWdlXG4gKiBgYGBqc1xuICogaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuICogaW1wb3J0IHsgVmlldyB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG4gKiBpbXBvcnQgeyBCdXR0b24sIE1lbnUsIERpdmlkZXIsIFByb3ZpZGVyIH0gZnJvbSAncmVhY3QtbmF0aXZlLXBhcGVyJztcbiAqXG4gKiBjb25zdCBNeUNvbXBvbmVudCA9ICgpID0+IHtcbiAqICAgY29uc3QgW3Zpc2libGUsIHNldFZpc2libGVdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuICpcbiAqICAgY29uc3Qgb3Blbk1lbnUgPSAoKSA9PiBzZXRWaXNpYmxlKHRydWUpO1xuICpcbiAqICAgY29uc3QgY2xvc2VNZW51ID0gKCkgPT4gc2V0VmlzaWJsZShmYWxzZSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxQcm92aWRlcj5cbiAqICAgICAgIDxWaWV3XG4gKiAgICAgICAgIHN0eWxlPXt7XG4gKiAgICAgICAgICAgcGFkZGluZ1RvcDogNTAsXG4gKiAgICAgICAgICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gKiAgICAgICAgICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICogICAgICAgICB9fT5cbiAqICAgICAgICAgPE1lbnVcbiAqICAgICAgICAgICB2aXNpYmxlPXt2aXNpYmxlfVxuICogICAgICAgICAgIG9uRGlzbWlzcz17Y2xvc2VNZW51fVxuICogICAgICAgICAgIGFuY2hvcj17PEJ1dHRvbiBvblByZXNzPXtvcGVuTWVudX0+U2hvdyBtZW51PC9CdXR0b24+fT5cbiAqICAgICAgICAgICA8TWVudS5JdGVtIG9uUHJlc3M9eygpID0+IHt9fSB0aXRsZT1cIkl0ZW0gMVwiIC8+XG4gKiAgICAgICAgICAgPE1lbnUuSXRlbSBvblByZXNzPXsoKSA9PiB7fX0gdGl0bGU9XCJJdGVtIDJcIiAvPlxuICogICAgICAgICAgIDxEaXZpZGVyIC8+XG4gKiAgICAgICAgICAgPE1lbnUuSXRlbSBvblByZXNzPXsoKSA9PiB7fX0gdGl0bGU9XCJJdGVtIDNcIiAvPlxuICogICAgICAgICA8L01lbnU+XG4gKiAgICAgICA8L1ZpZXc+XG4gKiAgICAgPC9Qcm92aWRlcj5cbiAqICAgKTtcbiAqIH07XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgTXlDb21wb25lbnQ7XG4gKiBgYGBcbiAqL1xuY2xhc3MgTWVudSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgLy8gQGNvbXBvbmVudCAuL01lbnVJdGVtLnRzeFxuICBzdGF0aWMgSXRlbSA9IE1lbnVJdGVtO1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgc3RhdHVzQmFySGVpZ2h0OiBBUFBST1hfU1RBVFVTQkFSX0hFSUdIVCxcbiAgICBvdmVybGF5QWNjZXNzaWJpbGl0eUxhYmVsOiAnQ2xvc2UgbWVudScsXG4gIH07XG5cbiAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhuZXh0UHJvcHM6IFByb3BzLCBwcmV2U3RhdGU6IFN0YXRlKSB7XG4gICAgaWYgKG5leHRQcm9wcy52aXNpYmxlICYmICFwcmV2U3RhdGUucmVuZGVyZWQpIHtcbiAgICAgIHJldHVybiB7IHJlbmRlcmVkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBzdGF0ZSA9IHtcbiAgICByZW5kZXJlZDogdGhpcy5wcm9wcy52aXNpYmxlLFxuICAgIHRvcDogMCxcbiAgICBsZWZ0OiAwLFxuICAgIG1lbnVMYXlvdXQ6IHsgd2lkdGg6IDAsIGhlaWdodDogMCB9LFxuICAgIGFuY2hvckxheW91dDogeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0sXG4gICAgb3BhY2l0eUFuaW1hdGlvbjogbmV3IEFuaW1hdGVkLlZhbHVlKDApLFxuICAgIHNjYWxlQW5pbWF0aW9uOiBuZXcgQW5pbWF0ZWQuVmFsdWVYWSh7IHg6IDAsIHk6IDAgfSksXG4gIH07XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wczogUHJvcHMpIHtcbiAgICBpZiAocHJldlByb3BzLnZpc2libGUgIT09IHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgdGhpcy51cGRhdGVWaXNpYmlsaXR5KCk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgYW5jaG9yPzogVmlldyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG1lbnU/OiBWaWV3IHwgbnVsbCA9IG51bGw7XG5cbiAgcHJpdmF0ZSBpc0FuY2hvckNvb3JkID0gKCkgPT4gIVJlYWN0LmlzVmFsaWRFbGVtZW50KHRoaXMucHJvcHMuYW5jaG9yKTtcblxuICBwcml2YXRlIG1lYXN1cmVNZW51TGF5b3V0ID0gKCkgPT5cbiAgICBuZXcgUHJvbWlzZTxMYXlvdXRSZWN0YW5nbGU+KChyZXNvbHZlKSA9PiB7XG4gICAgICBpZiAodGhpcy5tZW51KSB7XG4gICAgICAgIHRoaXMubWVudS5tZWFzdXJlSW5XaW5kb3coKHgsIHksIHdpZHRoLCBoZWlnaHQpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHsgeCwgeSwgd2lkdGgsIGhlaWdodCB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgcHJpdmF0ZSBtZWFzdXJlQW5jaG9yTGF5b3V0ID0gKCkgPT5cbiAgICBuZXcgUHJvbWlzZTxMYXlvdXRSZWN0YW5nbGU+KChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB7IGFuY2hvciB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGlmICh0aGlzLmlzQW5jaG9yQ29vcmQoKSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJlc29sdmUoeyB4OiBhbmNob3IueCwgeTogYW5jaG9yLnksIHdpZHRoOiAwLCBoZWlnaHQ6IDAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuYW5jaG9yKSB7XG4gICAgICAgIHRoaXMuYW5jaG9yLm1lYXN1cmVJbldpbmRvdygoeCwgeSwgd2lkdGgsIGhlaWdodCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUoeyB4LCB5LCB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICBwcml2YXRlIHVwZGF0ZVZpc2liaWxpdHkgPSBhc3luYyAoKSA9PiB7XG4gICAgLy8gTWVudSBpcyByZW5kZXJlZCBpbiBQb3J0YWwsIHdoaWNoIHVwZGF0ZXMgaXRlbXMgYXN5bmNocm9ub3VzbHlcbiAgICAvLyBXZSBuZWVkIHRvIGRvIHRoZSBzYW1lIGhlcmUgc28gdGhhdCB0aGUgcmVmIGlzIHVwLXRvLWRhdGVcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTtcblxuICAgIGlmICh0aGlzLnByb3BzLnZpc2libGUpIHtcbiAgICAgIHRoaXMuc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhpZGUoKTtcbiAgICB9XG4gIH07XG5cbiAgcHJpdmF0ZSBpc0Jyb3dzZXIgPSAoKSA9PiBQbGF0Zm9ybS5PUyA9PT0gJ3dlYicgJiYgJ2RvY3VtZW50JyBpbiBnbG9iYWw7XG5cbiAgcHJpdmF0ZSBmb2N1c0ZpcnN0RE9NTm9kZSA9IChlbDogVmlldyB8IG51bGwgfCB1bmRlZmluZWQpID0+IHtcbiAgICBpZiAoZWwgJiYgdGhpcy5pc0Jyb3dzZXIoKSkge1xuICAgICAgLy8gV2hlbiBpbiB0aGUgYnJvd3Nlciwgd2Ugd2FudCB0byBmb2N1cyB0aGUgZmlyc3QgZm9jdXNhYmxlIGl0ZW0gb24gdG9nZ2xlXG4gICAgICAvLyBGb3IgZXhhbXBsZSwgd2hlbiBtZW51IGlzIHNob3duLCBmb2N1cyB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgbWVudVxuICAgICAgLy8gQW5kIHdoZW4gbWVudSBpcyBkaXNtaXNzZWQsIHNlbmQgZm9jdXMgYmFjayB0byB0aGUgYnV0dG9uIHRvIHJlc3VtZSB0YWJiaW5nXG4gICAgICBjb25zdCBub2RlOiBhbnkgPSBmaW5kTm9kZUhhbmRsZShlbCk7XG4gICAgICBjb25zdCBmb2N1c2FibGVOb2RlID0gbm9kZS5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAvLyBUaGlzIGlzIGEgcm91Z2ggbGlzdCBvZiBzZWxlY3RvcnMgdGhhdCBjYW4gYmUgZm9jdXNlZFxuICAgICAgICAnYnV0dG9uLCBbaHJlZl0sIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9XCItMVwiXSknXG4gICAgICApO1xuXG4gICAgICBmb2N1c2FibGVOb2RlPy5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBwcml2YXRlIGhhbmRsZURpc21pc3MgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgdGhpcy5wcm9wcy5vbkRpc21pc3MoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgcHJpdmF0ZSBoYW5kbGVLZXlwcmVzcyA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5wcm9wcy5vbkRpc21pc3MoKTtcbiAgICB9XG4gIH07XG5cbiAgcHJpdmF0ZSBhdHRhY2hMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgQmFja0hhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcignaGFyZHdhcmVCYWNrUHJlc3MnLCB0aGlzLmhhbmRsZURpc21pc3MpO1xuICAgIERpbWVuc2lvbnMuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5oYW5kbGVEaXNtaXNzKTtcblxuICAgIHRoaXMuaXNCcm93c2VyKCkgJiYgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmhhbmRsZUtleXByZXNzKTtcbiAgfTtcblxuICBwcml2YXRlIHJlbW92ZUxpc3RlbmVycyA9ICgpID0+IHtcbiAgICBCYWNrSGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXJkd2FyZUJhY2tQcmVzcycsIHRoaXMuaGFuZGxlRGlzbWlzcyk7XG4gICAgRGltZW5zaW9ucy5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLmhhbmRsZURpc21pc3MpO1xuXG4gICAgdGhpcy5pc0Jyb3dzZXIoKSAmJlxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmhhbmRsZUtleXByZXNzKTtcbiAgfTtcblxuICBwcml2YXRlIHNob3cgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgd2luZG93TGF5b3V0ID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpO1xuICAgIGNvbnN0IFttZW51TGF5b3V0LCBhbmNob3JMYXlvdXRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5tZWFzdXJlTWVudUxheW91dCgpLFxuICAgICAgdGhpcy5tZWFzdXJlQW5jaG9yTGF5b3V0KCksXG4gICAgXSk7XG5cbiAgICAvLyBXaGVuIHZpc2libGUgaXMgdHJ1ZSBmb3IgZmlyc3QgcmVuZGVyXG4gICAgLy8gbmF0aXZlIHZpZXdzIGNhbiBiZSBzdGlsbCBub3QgcmVuZGVyZWQgYW5kXG4gICAgLy8gbWVhc3VyZU1lbnVMYXlvdXQvbWVhc3VyZUFuY2hvckxheW91dCBmdW5jdGlvbnNcbiAgICAvLyByZXR1cm4gd3JvbmcgdmFsdWVzIGUuZyB7IHg6MCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9XG4gICAgLy8gc28gd2UgaGF2ZSB0byB3YWl0IHVudGlsIHZpZXdzIGFyZSByZWFkeVxuICAgIC8vIGFuZCByZXJ1biB0aGlzIGZ1bmN0aW9uIHRvIHNob3cgbWVudVxuICAgIGlmIChcbiAgICAgICF3aW5kb3dMYXlvdXQud2lkdGggfHxcbiAgICAgICF3aW5kb3dMYXlvdXQuaGVpZ2h0IHx8XG4gICAgICAhbWVudUxheW91dC53aWR0aCB8fFxuICAgICAgIW1lbnVMYXlvdXQuaGVpZ2h0IHx8XG4gICAgICAoIWFuY2hvckxheW91dC53aWR0aCAmJiAhdGhpcy5pc0FuY2hvckNvb3JkKCkpIHx8XG4gICAgICAoIWFuY2hvckxheW91dC5oZWlnaHQgJiYgIXRoaXMuaXNBbmNob3JDb29yZCgpKVxuICAgICkge1xuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuc2hvdyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICgpID0+ICh7XG4gICAgICAgIGxlZnQ6IGFuY2hvckxheW91dC54LFxuICAgICAgICB0b3A6IGFuY2hvckxheW91dC55LFxuICAgICAgICBhbmNob3JMYXlvdXQ6IHtcbiAgICAgICAgICBoZWlnaHQ6IGFuY2hvckxheW91dC5oZWlnaHQsXG4gICAgICAgICAgd2lkdGg6IGFuY2hvckxheW91dC53aWR0aCxcbiAgICAgICAgfSxcbiAgICAgICAgbWVudUxheW91dDoge1xuICAgICAgICAgIHdpZHRoOiBtZW51TGF5b3V0LndpZHRoLFxuICAgICAgICAgIGhlaWdodDogbWVudUxheW91dC5oZWlnaHQsXG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5hdHRhY2hMaXN0ZW5lcnMoKTtcblxuICAgICAgICBjb25zdCB7IGFuaW1hdGlvbiB9ID0gdGhpcy5wcm9wcy50aGVtZTtcbiAgICAgICAgQW5pbWF0ZWQucGFyYWxsZWwoW1xuICAgICAgICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLnNjYWxlQW5pbWF0aW9uLCB7XG4gICAgICAgICAgICB0b1ZhbHVlOiB7IHg6IG1lbnVMYXlvdXQud2lkdGgsIHk6IG1lbnVMYXlvdXQuaGVpZ2h0IH0sXG4gICAgICAgICAgICBkdXJhdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OICogYW5pbWF0aW9uLnNjYWxlLFxuICAgICAgICAgICAgZWFzaW5nOiBFQVNJTkcsXG4gICAgICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuc3RhdGUub3BhY2l0eUFuaW1hdGlvbiwge1xuICAgICAgICAgICAgdG9WYWx1ZTogMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBBTklNQVRJT05fRFVSQVRJT04gKiBhbmltYXRpb24uc2NhbGUsXG4gICAgICAgICAgICBlYXNpbmc6IEVBU0lORyxcbiAgICAgICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSkuc3RhcnQoKHsgZmluaXNoZWQgfSkgPT4ge1xuICAgICAgICAgIGlmIChmaW5pc2hlZCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c0ZpcnN0RE9NTm9kZSh0aGlzLm1lbnUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgKTtcbiAgfTtcblxuICBwcml2YXRlIGhpZGUgPSAoKSA9PiB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcnMoKTtcblxuICAgIGNvbnN0IHsgYW5pbWF0aW9uIH0gPSB0aGlzLnByb3BzLnRoZW1lO1xuICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLm9wYWNpdHlBbmltYXRpb24sIHtcbiAgICAgIHRvVmFsdWU6IDAsXG4gICAgICBkdXJhdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OICogYW5pbWF0aW9uLnNjYWxlLFxuICAgICAgZWFzaW5nOiBFQVNJTkcsXG4gICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgfSkuc3RhcnQoKHsgZmluaXNoZWQgfSkgPT4ge1xuICAgICAgaWYgKGZpbmlzaGVkKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZW51TGF5b3V0OiB7IHdpZHRoOiAwLCBoZWlnaHQ6IDAgfSwgcmVuZGVyZWQ6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLnN0YXRlLnNjYWxlQW5pbWF0aW9uLnNldFZhbHVlKHsgeDogMCwgeTogMCB9KTtcbiAgICAgICAgdGhpcy5mb2N1c0ZpcnN0RE9NTm9kZSh0aGlzLmFuY2hvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHZpc2libGUsXG4gICAgICBhbmNob3IsXG4gICAgICBjb250ZW50U3R5bGUsXG4gICAgICBzdHlsZSxcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgdGhlbWUsXG4gICAgICBzdGF0dXNCYXJIZWlnaHQsXG4gICAgICBvbkRpc21pc3MsXG4gICAgICBvdmVybGF5QWNjZXNzaWJpbGl0eUxhYmVsLFxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3Qge1xuICAgICAgcmVuZGVyZWQsXG4gICAgICBtZW51TGF5b3V0LFxuICAgICAgYW5jaG9yTGF5b3V0LFxuICAgICAgb3BhY2l0eUFuaW1hdGlvbixcbiAgICAgIHNjYWxlQW5pbWF0aW9uLFxuICAgIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgbGV0IHsgbGVmdCwgdG9wIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgLy8gSSBkb24ndCBrbm93IHdoeSBidXQgb24gQW5kcm9pZCBtZWFzdXJlIGZ1bmN0aW9uIGlzIHdyb25nIGJ5IDI0XG4gICAgY29uc3QgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWUgPSBQbGF0Zm9ybS5zZWxlY3Qoe1xuICAgICAgYW5kcm9pZDogc3RhdHVzQmFySGVpZ2h0LFxuICAgICAgZGVmYXVsdDogMCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHNjYWxlVHJhbnNmb3JtcyA9IFtcbiAgICAgIHtcbiAgICAgICAgc2NhbGVYOiBzY2FsZUFuaW1hdGlvbi54LmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgbWVudUxheW91dC53aWR0aF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzY2FsZVk6IHNjYWxlQW5pbWF0aW9uLnkuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCBtZW51TGF5b3V0LmhlaWdodF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgIF07XG5cbiAgICBjb25zdCB3aW5kb3dMYXlvdXQgPSBEaW1lbnNpb25zLmdldCgnd2luZG93Jyk7XG5cbiAgICAvLyBXZSBuZWVkIHRvIHRyYW5zbGF0ZSBtZW51IHdoaWxlIGFuaW1hdGluZyBzY2FsZSB0byBpbWl0YXRlIHRyYW5zZm9ybSBvcmlnaW4gZm9yIHNjYWxlIGFuaW1hdGlvblxuICAgIGNvbnN0IHBvc2l0aW9uVHJhbnNmb3JtcyA9IFtdO1xuXG4gICAgLy8gQ2hlY2sgaWYgbWVudSBmaXRzIGhvcml6b250YWxseSBhbmQgaWYgbm90IGFsaWduIGl0IHRvIHJpZ2h0LlxuICAgIGlmIChsZWZ0IDw9IHdpbmRvd0xheW91dC53aWR0aCAtIG1lbnVMYXlvdXQud2lkdGggLSBTQ1JFRU5fSU5ERU5UKSB7XG4gICAgICBwb3NpdGlvblRyYW5zZm9ybXMucHVzaCh7XG4gICAgICAgIHRyYW5zbGF0ZVg6IHNjYWxlQW5pbWF0aW9uLnguaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCBtZW51TGF5b3V0LndpZHRoXSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWy0obWVudUxheW91dC53aWR0aCAvIDIpLCAwXSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hlY2sgaWYgbWVudSBwb3NpdGlvbiBoYXMgZW5vdWdoIHNwYWNlIGZyb20gbGVmdCBzaWRlXG4gICAgICBpZiAobGVmdCA8IFNDUkVFTl9JTkRFTlQpIHtcbiAgICAgICAgbGVmdCA9IFNDUkVFTl9JTkRFTlQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvc2l0aW9uVHJhbnNmb3Jtcy5wdXNoKHtcbiAgICAgICAgdHJhbnNsYXRlWDogc2NhbGVBbmltYXRpb24ueC5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIG1lbnVMYXlvdXQud2lkdGhdLFxuICAgICAgICAgIG91dHB1dFJhbmdlOiBbbWVudUxheW91dC53aWR0aCAvIDIsIDBdLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBsZWZ0ICs9IGFuY2hvckxheW91dC53aWR0aCAtIG1lbnVMYXlvdXQud2lkdGg7XG5cbiAgICAgIGNvbnN0IHJpZ2h0ID0gbGVmdCArIG1lbnVMYXlvdXQud2lkdGg7XG4gICAgICAvLyBDaGVjayBpZiBtZW51IHBvc2l0aW9uIGhhcyBlbm91Z2ggc3BhY2UgZnJvbSByaWdodCBzaWRlXG4gICAgICBpZiAocmlnaHQgPiB3aW5kb3dMYXlvdXQud2lkdGggLSBTQ1JFRU5fSU5ERU5UKSB7XG4gICAgICAgIGxlZnQgPSB3aW5kb3dMYXlvdXQud2lkdGggLSBTQ1JFRU5fSU5ERU5UIC0gbWVudUxheW91dC53aWR0aDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgbWVudSBpcyBsYXJnZXIgdGhhbiBhdmFpbGFibGUgdmVydGljYWwgc3BhY2UsXG4gICAgLy8gY2FsY3VsYXRlIHRoZSBoZWlnaHQgb2Ygc2Nyb2xsYWJsZSB2aWV3XG4gICAgbGV0IHNjcm9sbGFibGVNZW51SGVpZ2h0ID0gMDtcblxuICAgIC8vIENoZWNrIGlmIHRoZSBtZW51IHNob3VsZCBiZSBzY3JvbGxhYmxlXG4gICAgaWYgKFxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIG1lbnUgb3ZlcmZsb3dzIGZyb20gYm90dG9tIHNpZGVcbiAgICAgIHRvcCA+PVxuICAgICAgICB3aW5kb3dMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICBtZW51TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgU0NSRUVOX0lOREVOVCAtXG4gICAgICAgICAgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWUgJiZcbiAgICAgIC8vIEFuZCBib3R0b20gc2lkZSBvZiB0aGUgc2NyZWVuIGhhcyBtb3JlIHNwYWNlIHRoYW4gdG9wIHNpZGVcbiAgICAgIHRvcCA8PSB3aW5kb3dMYXlvdXQuaGVpZ2h0IC0gdG9wXG4gICAgKSB7XG4gICAgICAvLyBTY3JvbGxhYmxlIG1lbnUgc2hvdWxkIGJlIGJlbG93IHRoZSBhbmNob3IgKGV4cGFuZHMgZG93bndhcmRzKVxuICAgICAgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPVxuICAgICAgICB3aW5kb3dMYXlvdXQuaGVpZ2h0IC0gdG9wIC0gU0NSRUVOX0lOREVOVCAtIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICAvLyBDaGVjayBpZiB0aGUgbWVudSBvdmVyZmxvd3MgZnJvbSBib3R0b20gc2lkZVxuICAgICAgdG9wID49XG4gICAgICAgIHdpbmRvd0xheW91dC5oZWlnaHQgLVxuICAgICAgICAgIG1lbnVMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICBTQ1JFRU5fSU5ERU5UIC1cbiAgICAgICAgICBhZGRpdGlvbmFsVmVydGljYWxWYWx1ZSAmJlxuICAgICAgLy8gQW5kIHRvcCBzaWRlIG9mIHRoZSBzY3JlZW4gaGFzIG1vcmUgc3BhY2UgdGhhbiBib3R0b20gc2lkZVxuICAgICAgdG9wID49IHdpbmRvd0xheW91dC5oZWlnaHQgLSB0b3AgJiZcbiAgICAgIC8vIEFuZCBtZW51IG92ZXJmbG93cyBmcm9tIHRvcCBzaWRlXG4gICAgICB0b3AgPD1cbiAgICAgICAgbWVudUxheW91dC5oZWlnaHQgLVxuICAgICAgICAgIGFuY2hvckxheW91dC5oZWlnaHQgK1xuICAgICAgICAgIFNDUkVFTl9JTkRFTlQgLVxuICAgICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlXG4gICAgKSB7XG4gICAgICAvLyBTY3JvbGxhYmxlIG1lbnUgc2hvdWxkIGJlIGFib3ZlIHRoZSBhbmNob3IgKGV4cGFuZHMgdXB3YXJkcylcbiAgICAgIHNjcm9sbGFibGVNZW51SGVpZ2h0ID1cbiAgICAgICAgdG9wICsgYW5jaG9yTGF5b3V0LmhlaWdodCAtIFNDUkVFTl9JTkRFTlQgKyBhZGRpdGlvbmFsVmVydGljYWxWYWx1ZTtcbiAgICB9XG5cbiAgICAvLyBTY3JvbGxhYmxlIG1lbnUgbWF4IGhlaWdodFxuICAgIHNjcm9sbGFibGVNZW51SGVpZ2h0ID1cbiAgICAgIHNjcm9sbGFibGVNZW51SGVpZ2h0ID4gd2luZG93TGF5b3V0LmhlaWdodCAtIDIgKiBTQ1JFRU5fSU5ERU5UXG4gICAgICAgID8gd2luZG93TGF5b3V0LmhlaWdodCAtIDIgKiBTQ1JFRU5fSU5ERU5UXG4gICAgICAgIDogc2Nyb2xsYWJsZU1lbnVIZWlnaHQ7XG5cbiAgICAvLyBNZW51IGlzIHR5cGljYWxseSBwb3NpdGlvbmVkIGJlbG93IHRoZSBlbGVtZW50IHRoYXQgZ2VuZXJhdGVzIGl0XG4gICAgLy8gU28gZmlyc3QgY2hlY2sgaWYgaXQgZml0cyBiZWxvdyB0aGUgYW5jaG9yIChleHBhbmRzIGRvd253YXJkcylcbiAgICBpZiAoXG4gICAgICAvLyBDaGVjayBpZiBtZW51IGZpdHMgdmVydGljYWxseVxuICAgICAgdG9wIDw9XG4gICAgICAgIHdpbmRvd0xheW91dC5oZWlnaHQgLVxuICAgICAgICAgIG1lbnVMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICBTQ1JFRU5fSU5ERU5UIC1cbiAgICAgICAgICBhZGRpdGlvbmFsVmVydGljYWxWYWx1ZSB8fFxuICAgICAgLy8gT3IgaWYgdGhlIG1lbnUgb3ZlcmZsb3dzIGZyb20gYm90dG9tIHNpZGVcbiAgICAgICh0b3AgPj1cbiAgICAgICAgd2luZG93TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgbWVudUxheW91dC5oZWlnaHQgLVxuICAgICAgICAgIFNDUkVFTl9JTkRFTlQgLVxuICAgICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlICYmXG4gICAgICAgIC8vIEFuZCBib3R0b20gc2lkZSBvZiB0aGUgc2NyZWVuIGhhcyBtb3JlIHNwYWNlIHRoYW4gdG9wIHNpZGVcbiAgICAgICAgdG9wIDw9IHdpbmRvd0xheW91dC5oZWlnaHQgLSB0b3ApXG4gICAgKSB7XG4gICAgICBwb3NpdGlvblRyYW5zZm9ybXMucHVzaCh7XG4gICAgICAgIHRyYW5zbGF0ZVk6IHNjYWxlQW5pbWF0aW9uLnkuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCBtZW51TGF5b3V0LmhlaWdodF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFstKChzY3JvbGxhYmxlTWVudUhlaWdodCB8fCBtZW51TGF5b3V0LmhlaWdodCkgLyAyKSwgMF0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIGlmIG1lbnUgcG9zaXRpb24gaGFzIGVub3VnaCBzcGFjZSBmcm9tIHRvcCBzaWRlXG4gICAgICBpZiAodG9wIDwgU0NSRUVOX0lOREVOVCkge1xuICAgICAgICB0b3AgPSBTQ1JFRU5fSU5ERU5UO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBwb3NpdGlvblRyYW5zZm9ybXMucHVzaCh7XG4gICAgICAgIHRyYW5zbGF0ZVk6IHNjYWxlQW5pbWF0aW9uLnkuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCBtZW51TGF5b3V0LmhlaWdodF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFsoc2Nyb2xsYWJsZU1lbnVIZWlnaHQgfHwgbWVudUxheW91dC5oZWlnaHQpIC8gMiwgMF0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIHRvcCArPSBhbmNob3JMYXlvdXQuaGVpZ2h0IC0gKHNjcm9sbGFibGVNZW51SGVpZ2h0IHx8IG1lbnVMYXlvdXQuaGVpZ2h0KTtcblxuICAgICAgY29uc3QgYm90dG9tID1cbiAgICAgICAgdG9wICtcbiAgICAgICAgKHNjcm9sbGFibGVNZW51SGVpZ2h0IHx8IG1lbnVMYXlvdXQuaGVpZ2h0KSArXG4gICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlO1xuXG4gICAgICAvLyBDaGVjayBpZiBtZW51IHBvc2l0aW9uIGhhcyBlbm91Z2ggc3BhY2UgZnJvbSBib3R0b20gc2lkZVxuICAgICAgaWYgKGJvdHRvbSA+IHdpbmRvd0xheW91dC5oZWlnaHQgLSBTQ1JFRU5fSU5ERU5UKSB7XG4gICAgICAgIHRvcCA9XG4gICAgICAgICAgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPT09IHdpbmRvd0xheW91dC5oZWlnaHQgLSAyICogU0NSRUVOX0lOREVOVFxuICAgICAgICAgICAgPyAtU0NSRUVOX0lOREVOVCAqIDJcbiAgICAgICAgICAgIDogd2luZG93TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgICAgIG1lbnVMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICAgICAgU0NSRUVOX0lOREVOVCAtXG4gICAgICAgICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHNoYWRvd01lbnVDb250YWluZXJTdHlsZSA9IHtcbiAgICAgIG9wYWNpdHk6IG9wYWNpdHlBbmltYXRpb24sXG4gICAgICB0cmFuc2Zvcm06IHNjYWxlVHJhbnNmb3JtcyxcbiAgICAgIGJvcmRlclJhZGl1czogdGhlbWUucm91bmRuZXNzLFxuICAgICAgLi4uKHNjcm9sbGFibGVNZW51SGVpZ2h0ID8geyBoZWlnaHQ6IHNjcm9sbGFibGVNZW51SGVpZ2h0IH0gOiB7fSksXG4gICAgfTtcblxuICAgIGNvbnN0IHBvc2l0aW9uU3R5bGUgPSB7XG4gICAgICB0b3A6IHRoaXMuaXNBbmNob3JDb29yZCgpID8gdG9wIDogdG9wICsgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWUsXG4gICAgICAuLi4oSTE4bk1hbmFnZXIuaXNSVEwgPyB7IHJpZ2h0OiBsZWZ0IH0gOiB7IGxlZnQgfSksXG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8Vmlld1xuICAgICAgICByZWY9eyhyZWYpID0+IHtcbiAgICAgICAgICB0aGlzLmFuY2hvciA9IHJlZjtcbiAgICAgICAgfX1cbiAgICAgICAgY29sbGFwc2FibGU9e2ZhbHNlfVxuICAgICAgPlxuICAgICAgICB7dGhpcy5pc0FuY2hvckNvb3JkKCkgPyBudWxsIDogYW5jaG9yfVxuICAgICAgICB7cmVuZGVyZWQgPyAoXG4gICAgICAgICAgPFBvcnRhbD5cbiAgICAgICAgICAgIDxUb3VjaGFibGVXaXRob3V0RmVlZGJhY2tcbiAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXtvdmVybGF5QWNjZXNzaWJpbGl0eUxhYmVsfVxuICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgIG9uUHJlc3M9e29uRGlzbWlzc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFZpZXcgc3R5bGU9e1N0eWxlU2hlZXQuYWJzb2x1dGVGaWxsfSAvPlxuICAgICAgICAgICAgPC9Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2s+XG4gICAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgICByZWY9eyhyZWYpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUgPSByZWY7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIGNvbGxhcHNhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVZpZXdJc01vZGFsPXt2aXNpYmxlfVxuICAgICAgICAgICAgICBzdHlsZT17W3N0eWxlcy53cmFwcGVyLCBwb3NpdGlvblN0eWxlLCBzdHlsZV19XG4gICAgICAgICAgICAgIHBvaW50ZXJFdmVudHM9e3Zpc2libGUgPyAnYm94LW5vbmUnIDogJ25vbmUnfVxuICAgICAgICAgICAgICBvbkFjY2Vzc2liaWxpdHlFc2NhcGU9e29uRGlzbWlzc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e3sgdHJhbnNmb3JtOiBwb3NpdGlvblRyYW5zZm9ybXMgfX0+XG4gICAgICAgICAgICAgICAgPFN1cmZhY2VcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlcy5zaGFkb3dNZW51Q29udGFpbmVyLFxuICAgICAgICAgICAgICAgICAgICAgIHNoYWRvd01lbnVDb250YWluZXJTdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3R5bGUsXG4gICAgICAgICAgICAgICAgICAgIF0gYXMgU3R5bGVQcm9wPFZpZXdTdHlsZT5cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7KHNjcm9sbGFibGVNZW51SGVpZ2h0ICYmIChcbiAgICAgICAgICAgICAgICAgICAgPFNjcm9sbFZpZXc+e2NoaWxkcmVufTwvU2Nyb2xsVmlldz5cbiAgICAgICAgICAgICAgICAgICkpIHx8IDxSZWFjdC5GcmFnbWVudD57Y2hpbGRyZW59PC9SZWFjdC5GcmFnbWVudD59XG4gICAgICAgICAgICAgICAgPC9TdXJmYWNlPlxuICAgICAgICAgICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgPC9Qb3J0YWw+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgPC9WaWV3PlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICB3cmFwcGVyOiB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIH0sXG4gIHNoYWRvd01lbnVDb250YWluZXI6IHtcbiAgICBvcGFjaXR5OiAwLFxuICAgIHBhZGRpbmdWZXJ0aWNhbDogOCxcbiAgICBlbGV2YXRpb246IDgsXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKE1lbnUpO1xuIl19