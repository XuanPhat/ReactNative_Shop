300af811aa380ed21e2fb6b034f165d1
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.getElementVisibleWidth = void 0;

var getArea = function getArea(a, b) {
  return a * b;
};

var getPointDistance = function getPointDistance(a, b) {
  return Math.sqrt(Math.pow(a[0] - b[0], 2) + Math.pow(a[1] - b[1], 2));
};

var getElementVisibleWidth = function getElementVisibleWidth(elementWidth, xOffset, ScreenWidth) {
  if (xOffset >= 0) {
    return xOffset + elementWidth <= ScreenWidth ? elementWidth : ScreenWidth - xOffset;
  }

  return elementWidth - xOffset;
};

exports.getElementVisibleWidth = getElementVisibleWidth;

var getTooltipCoordinate = function getTooltipCoordinate(x, y, width, height, ScreenWidth, ScreenHeight, tooltipWidth, tooltipHeight, withPointer) {
  var center = [x + getElementVisibleWidth(width, x, ScreenWidth) / 2, y + height / 2];
  var pOne = [center[0], 0];
  var pTwo = [ScreenWidth, center[1]];
  var pThree = [center[0], ScreenHeight];
  var pFour = [0, center[1]];
  var vOne = getPointDistance(center, pOne);
  var vTwo = getPointDistance(center, pTwo);
  var vThree = getPointDistance(center, pThree);
  var vFour = getPointDistance(center, pFour);
  var areas = [getArea(vOne, vFour), getArea(vOne, vTwo), getArea(vTwo, vThree), getArea(vThree, vFour)].map(function (each, index) {
    return {
      area: each,
      id: index
    };
  });
  var sortedArea = areas.sort(function (a, b) {
    return b.area - a.area;
  });
  var dX = 0.001;
  var dY = height / 2;
  var directionCorrection = [[-1, -1], [1, -1], [1, 1], [-1, 1]];
  var deslocateReferencePoint = [[-tooltipWidth, -tooltipHeight], [0, -tooltipHeight], [0, 0], [-tooltipWidth, 0]];
  var qIndex = sortedArea[0].id;

  var getWithPointerOffsetY = function getWithPointerOffsetY() {
    return withPointer ? 10 * directionCorrection[qIndex][1] : 0;
  };

  var getWithPointerOffsetX = function getWithPointerOffsetX() {
    return withPointer ? center[0] - 18 * directionCorrection[qIndex][0] : center[0];
  };

  var newX = getWithPointerOffsetX() + (dX * directionCorrection[qIndex][0] + deslocateReferencePoint[qIndex][0]);
  return {
    x: constraintX(newX, qIndex, center[0], ScreenWidth, tooltipWidth),
    y: center[1] + (dY * directionCorrection[qIndex][1] + deslocateReferencePoint[qIndex][1]) + getWithPointerOffsetY()
  };
};

var constraintX = function constraintX(newX, qIndex, x, ScreenWidth, tooltipWidth) {
  switch (qIndex) {
    case 0:
    case 3:
      {
        var maxWidth = newX > ScreenWidth ? ScreenWidth - 10 : newX;
        return newX < 1 ? 10 : maxWidth;
      }

    case 1:
    case 2:
      {
        var leftOverSpace = ScreenWidth - newX;
        return leftOverSpace >= tooltipWidth ? newX : newX - (tooltipWidth - leftOverSpace + 10);
      }

    default:
      {
        return 0;
      }
  }
};

var _default = getTooltipCoordinate;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFRvb2x0aXBDb29yZGluYXRlLmpzIl0sIm5hbWVzIjpbImdldEFyZWEiLCJhIiwiYiIsImdldFBvaW50RGlzdGFuY2UiLCJNYXRoIiwic3FydCIsInBvdyIsImdldEVsZW1lbnRWaXNpYmxlV2lkdGgiLCJlbGVtZW50V2lkdGgiLCJ4T2Zmc2V0IiwiU2NyZWVuV2lkdGgiLCJnZXRUb29sdGlwQ29vcmRpbmF0ZSIsIngiLCJ5Iiwid2lkdGgiLCJoZWlnaHQiLCJTY3JlZW5IZWlnaHQiLCJ0b29sdGlwV2lkdGgiLCJ0b29sdGlwSGVpZ2h0Iiwid2l0aFBvaW50ZXIiLCJjZW50ZXIiLCJwT25lIiwicFR3byIsInBUaHJlZSIsInBGb3VyIiwidk9uZSIsInZUd28iLCJ2VGhyZWUiLCJ2Rm91ciIsImFyZWFzIiwibWFwIiwiZWFjaCIsImluZGV4IiwiYXJlYSIsImlkIiwic29ydGVkQXJlYSIsInNvcnQiLCJkWCIsImRZIiwiZGlyZWN0aW9uQ29ycmVjdGlvbiIsImRlc2xvY2F0ZVJlZmVyZW5jZVBvaW50IiwicUluZGV4IiwiZ2V0V2l0aFBvaW50ZXJPZmZzZXRZIiwiZ2V0V2l0aFBvaW50ZXJPZmZzZXRYIiwibmV3WCIsImNvbnN0cmFpbnRYIiwibWF4V2lkdGgiLCJsZWZ0T3ZlclNwYWNlIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQU1BLE9BQU8sR0FBRyxTQUFWQSxPQUFVLENBQUNDLENBQUQsRUFBSUMsQ0FBSjtBQUFBLFNBQVVELENBQUMsR0FBR0MsQ0FBZDtBQUFBLENBQWhCOztBQUNBLElBQU1DLGdCQUFnQixHQUFHLFNBQW5CQSxnQkFBbUIsQ0FBQ0YsQ0FBRCxFQUFJQyxDQUFKO0FBQUEsU0FBVUUsSUFBSSxDQUFDQyxJQUFMLENBQVVELElBQUksQ0FBQ0UsR0FBTCxDQUFTTCxDQUFDLENBQUMsQ0FBRCxDQUFELEdBQU9DLENBQUMsQ0FBQyxDQUFELENBQWpCLEVBQXNCLENBQXRCLElBQTJCRSxJQUFJLENBQUNFLEdBQUwsQ0FBU0wsQ0FB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QUNDLE1BQUQsQ0FBdkIsQ0FBZ0MsQ0FBaEMsQ0FGTCxJQUdDQyxxQkFBcUI7QUFMdEIsR0FBUDtBQU9ILENBeEREOztBQXlEQSxJQUFNRyxXQUFXLEdBQUcsU0FBZEEsV0FBYyxDQUFDRCxJQUFELEVBQU9ILE1BQVAsRUFBZTdCLENBQWYsRUFBa0JGLFdBQWxCLEVBQStCTyxZQUEvQixFQUFnRDtBQUNoRSxVQUFRd0IsTUFBUjtBQUVJLFNBQUssQ0FBTDtBQUNBLFNBQUssQ0FBTDtBQUFRO0FBQ0osWUFBTUssUUFBUSxHQUFHRixJQUFJLEdBQUdsQyxXQUFQLEdBQXFCQSxXQUFXLEdBQUcsRUFBbkMsR0FBd0NrQyxJQUF6RDtBQUNBLGVBQU9BLElBQUksR0FBRyxDQUFQLEdBQVcsRUFBWCxHQUFnQkUsUUFBdkI7QUFDSDs7QUFFRCxTQUFLLENBQUw7QUFDQSxTQUFLLENBQUw7QUFBUTtBQUNKLFlBQU1DLGFBQWEsR0FBR3JDLFdBQVcsR0FBR2tDLElBQXBDO0FBQ0EsZUFBT0csYUFBYSxJQUFJOUIsWUFBakIsR0FDRDJCLElBREMsR0FFREEsSUFBSSxJQUFJM0IsWUFBWSxHQUFHOEIsYUFBZixHQUErQixFQUFuQyxDQUZWO0FBR0g7O0FBQ0Q7QUFBUztBQUNMLGVBQU8sQ0FBUDtBQUNIO0FBakJMO0FBbUJILENBcEJEOztlQXFCZXBDLG9CIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0QXJlYSA9IChhLCBiKSA9PiBhICogYjtcbmNvbnN0IGdldFBvaW50RGlzdGFuY2UgPSAoYSwgYikgPT4gTWF0aC5zcXJ0KE1hdGgucG93KGFbMF0gLSBiWzBdLCAyKSArIE1hdGgucG93KGFbMV0gLSBiWzFdLCAyKSk7XG5leHBvcnQgY29uc3QgZ2V0RWxlbWVudFZpc2libGVXaWR0aCA9IChlbGVtZW50V2lkdGgsIHhPZmZzZXQsIFNjcmVlbldpZHRoKSA9PiB7XG4gICAgLy8gRWxlbWVudCBpcyBmdWxseSB2aXNpYmxlIE9SIHNjcm9sbGVkIHJpZ2h0XG4gICAgaWYgKHhPZmZzZXQgPj0gMCkge1xuICAgICAgICByZXR1cm4geE9mZnNldCArIGVsZW1lbnRXaWR0aCA8PSBTY3JlZW5XaWR0aCAvLyBpcyBlbGVtZW50IGZ1bGx5IHZpc2libGU/XG4gICAgICAgICAgICA/IGVsZW1lbnRXaWR0aCAvLyBlbGVtZW50IGlzIGZ1bGx5IHZpc2libGU7XG4gICAgICAgICAgICA6IFNjcmVlbldpZHRoIC0geE9mZnNldDsgLy8gY2FsY3VsYXRlIHZpc2libGUgd2lkdGggb2Ygc2Nyb2xsZWQgZWxlbWVudFxuICAgIH1cbiAgICAvLyBFbGVtZW50IGlzIHNjcm9sbGVkIExFRlRcbiAgICByZXR1cm4gZWxlbWVudFdpZHRoIC0geE9mZnNldDsgLy8gY2FsY3VsYXRlIHZpc2libGUgd2lkdGggb2Ygc2Nyb2xsZWQgZWxlbWVudFxufTtcbi8qXG50eXBlIENvb3JkID0ge1xuICB4OiBudW1iZXIsXG4gIHk6IG51bWJlcixcbn07XG5cbiAgflRvb2x0aXAgY29vcmRpbmF0ZSBzeXN0ZW06flxuICBUaGUgdG9vbHRpcCBjb29yZGluYXRlcyBhcmUgYmFzZWQgb24gdGhlIGVsZW1lbnQgd2hpY2ggaXQgaXMgd3JhcHBpbmcuXG4gIFdlIHRha2UgdGhlIHggYW5kIHkgY29vcmRpbmF0ZXMgb2YgdGhlIGVsZW1lbnQgYW5kIGZpbmQgdGhlIGJlc3QgcG9zaXRpb25cbiAgdG8gcGxhY2UgdGhlIHRvb2x0aXAuIFRvIGZpbmQgdGhlIGJlc3QgcG9zaXRpb24gd2UgbG9vayBmb3IgdGhlIHNpZGUgd2l0aCB0aGVcbiAgbW9zdCBzcGFjZS4gSW4gb3JkZXIgdG8gZmluZCB0aGUgc2lkZSB3aXRoIHRoZSBtb3N0IHNwYWNlIHdlIGRpdmlkZSB0aGUgdGhlXG4gIHN1cnJvdW5kaW5ncyBpbiBmb3VyIHF1YWRyYW50cyBhbmQgY2hlY2sgZm9yIHRoZSBvbmUgd2l0aCBiaWdnZXN0IGFyZWEuXG4gIE9uY2Ugd2Uga25vdyB0aGUgcXVhbmRyYW50IHdpdGggdGhlIGJpZ2dlc3QgYXJlYSBpdCBwbGFjZSB0aGUgdG9vbHRpcCBpbiB0aGF0XG4gIGRpcmVjdGlvbi5cblxuICBUbyBmaW5kIHRoZSBhcmVhcyB3ZSBmaXJzdCBnZXQgNSBjb29yZGluYXRlIHBvaW50cy4gVGhlIGNlbnRlciBhbmQgdGhlIG90aGVyIDQgZXh0cmVtZSBwb2ludHNcbiAgd2hpY2ggdG9nZXRoZXIgbWFrZSBhIHBlcmZlY3QgY3Jvc3Mgc2hhcGUuXG5cbiAgT25jZSB3ZSBrbm93IHRoZSBjb29yZGluYXRlcyB3ZSBjYW4gZ2V0IHRoZSBsZW5ndGggb2YgdGhlIHZlcnRpY2VzIHdoaWNoIGZvcm0gZWFjaCBxdWFkcmFudC5cbiAgU2luY2UgdGhleSBhcmUgc3F1YXJlcyB3ZSBvbmx5IG5lZWQgdHdvLlxuKi9cbmNvbnN0IGdldFRvb2x0aXBDb29yZGluYXRlID0gKHgsIHksIHdpZHRoLCBoZWlnaHQsIFNjcmVlbldpZHRoLCBTY3JlZW5IZWlnaHQsIHRvb2x0aXBXaWR0aCwgdG9vbHRpcEhlaWdodCwgd2l0aFBvaW50ZXIpID0+IHtcbiAgICAvLyBUaGUgZm9sbG93aW5nIGFyZSBwb2ludCBjb29yZGluYXRlczogW3gsIHldXG4gICAgY29uc3QgY2VudGVyID0gW1xuICAgICAgICB4ICsgZ2V0RWxlbWVudFZpc2libGVXaWR0aCh3aWR0aCwgeCwgU2NyZWVuV2lkdGgpIC8gMixcbiAgICAgICAgeSArIGhlaWdodCAvIDIsXG4gICAgXTtcbiAgICBjb25zdCBwT25lID0gW2NlbnRlclswXSwgMF07XG4gICAgY29uc3QgcFR3byA9IFtTY3JlZW5XaWR0aCwgY2VudGVyWzFdXTtcbiAgICBjb25zdCBwVGhyZWUgPSBbY2VudGVyWzBdLCBTY3JlZW5IZWlnaHRdO1xuICAgIGNvbnN0IHBGb3VyID0gWzAsIGNlbnRlclsxXV07XG4gICAgLy8gdmVydGljZXNcbiAgICBjb25zdCB2T25lID0gZ2V0UG9pbnREaXN0YW5jZShjZW50ZXIsIHBPbmUpO1xuICAgIGNvbnN0IHZUd28gPSBnZXRQb2ludERpc3RhbmNlKGNlbnRlciwgcFR3byk7XG4gICAgY29uc3QgdlRocmVlID0gZ2V0UG9pbnREaXN0YW5jZShjZW50ZXIsIHBUaHJlZSk7XG4gICAgY29uc3QgdkZvdXIgPSBnZXRQb2ludERpc3RhbmNlKGNlbnRlciwgcEZvdXIpO1xuICAgIC8vIFF1YWRyYW50IGFyZWFzLlxuICAgIC8vIHR5cGUgQXJlYXMgPSB7XG4gICAgLy8gICBhcmVhOiBudW1iZXIsXG4gICAgLy8gICBpZDogbnVtYmVyLFxuICAgIC8vIH07XG4gICAgY29uc3QgYXJlYXMgPSBbXG4gICAgICAgIGdldEFyZWEodk9uZSwgdkZvdXIpLFxuICAgICAgICBnZXRBcmVhKHZPbmUsIHZUd28pLFxuICAgICAgICBnZXRBcmVhKHZUd28sIHZUaHJlZSksXG4gICAgICAgIGdldEFyZWEodlRocmVlLCB2Rm91ciksXG4gICAgXS5tYXAoKGVhY2gsIGluZGV4KSA9PiAoeyBhcmVhOiBlYWNoLCBpZDogaW5kZXggfSkpO1xuICAgIGNvbnN0IHNvcnRlZEFyZWEgPSBhcmVhcy5zb3J0KChhLCBiKSA9PiBiLmFyZWEgLSBhLmFyZWEpO1xuICAgIC8vIGRlc2xvY2F0ZWQgcG9pbnRzXG4gICAgY29uc3QgZFggPSAwLjAwMTtcbiAgICBjb25zdCBkWSA9IGhlaWdodCAvIDI7XG4gICAgLy8gRGVzbG9jYXRlIHRoZSBjb29yZGluYXRlcyBpbiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBxdWFkcmFudC5cbiAgICBjb25zdCBkaXJlY3Rpb25Db3JyZWN0aW9uID0gW1xuICAgICAgICBbLTEsIC0xXSxcbiAgICAgICAgWzEsIC0xXSxcbiAgICAgICAgWzEsIDFdLFxuICAgICAgICBbLTEsIDFdLFxuICAgIF07XG4gICAgY29uc3QgZGVzbG9jYXRlUmVmZXJlbmNlUG9pbnQgPSBbXG4gICAgICAgIFstdG9vbHRpcFdpZHRoLCAtdG9vbHRpcEhlaWdodF0sXG4gICAgICAgIFswLCAtdG9vbHRpcEhlaWdodF0sXG4gICAgICAgIFswLCAwXSxcbiAgICAgICAgWy10b29sdGlwV2lkdGgsIDBdLFxuICAgIF07XG4gICAgLy8gY3VycmVudCBxdWFkcmFudCBpbmRleFxuICAgIGNvbnN0IHFJbmRleCA9IHNvcnRlZEFyZWFbMF0uaWQ7XG4gICAgY29uc3QgZ2V0V2l0aFBvaW50ZXJPZmZzZXRZID0gKCkgPT4gd2l0aFBvaW50ZXIgPyAxMCAqIGRpcmVjdGlvbkNvcnJlY3Rpb25bcUluZGV4XVsxXSA6IDA7XG4gICAgY29uc3QgZ2V0V2l0aFBvaW50ZXJPZmZzZXRYID0gKCkgPT4gd2l0aFBvaW50ZXIgPyBjZW50ZXJbMF0gLSAxOCAqIGRpcmVjdGlvbkNvcnJlY3Rpb25bcUluZGV4XVswXSA6IGNlbnRlclswXTtcbiAgICBjb25zdCBuZXdYID0gZ2V0V2l0aFBvaW50ZXJPZmZzZXRYKCkgK1xuICAgICAgICAoZFggKiBkaXJlY3Rpb25Db3JyZWN0aW9uW3FJbmRleF1bMF0gKyBkZXNsb2NhdGVSZWZlcmVuY2VQb2ludFtxSW5kZXhdWzBdKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB4OiBjb25zdHJhaW50WChuZXdYLCBxSW5kZXgsIGNlbnRlclswXSwgU2NyZWVuV2lkdGgsIHRvb2x0aXBXaWR0aCksXG4gICAgICAgIHk6IGNlbnRlclsxXSArXG4gICAgICAgICAgICAoZFkgKiBkaXJlY3Rpb25Db3JyZWN0aW9uW3FJbmRleF1bMV0gK1xuICAgICAgICAgICAgICAgIGRlc2xvY2F0ZVJlZmVyZW5jZVBvaW50W3FJbmRleF1bMV0pICtcbiAgICAgICAgICAgIGdldFdpdGhQb2ludGVyT2Zmc2V0WSgpLFxuICAgIH07XG59O1xuY29uc3QgY29uc3RyYWludFggPSAobmV3WCwgcUluZGV4LCB4LCBTY3JlZW5XaWR0aCwgdG9vbHRpcFdpZHRoKSA9PiB7XG4gICAgc3dpdGNoIChxSW5kZXgpIHtcbiAgICAgICAgLy8gMCBhbmQgMyBhcmUgdGhlIGxlZnQgc2lkZSBxdWFkcmFudHMuXG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgICBjb25zdCBtYXhXaWR0aCA9IG5ld1ggPiBTY3JlZW5XaWR0aCA/IFNjcmVlbldpZHRoIC0gMTAgOiBuZXdYO1xuICAgICAgICAgICAgcmV0dXJuIG5ld1ggPCAxID8gMTAgOiBtYXhXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICAvLyAxIGFuZCAyIGFyZSB0aGUgcmlnaHQgc2lkZSBxdWFkcmFudHNcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICAgIGNvbnN0IGxlZnRPdmVyU3BhY2UgPSBTY3JlZW5XaWR0aCAtIG5ld1g7XG4gICAgICAgICAgICByZXR1cm4gbGVmdE92ZXJTcGFjZSA+PSB0b29sdGlwV2lkdGhcbiAgICAgICAgICAgICAgICA/IG5ld1hcbiAgICAgICAgICAgICAgICA6IG5ld1ggLSAodG9vbHRpcFdpZHRoIC0gbGVmdE92ZXJTcGFjZSArIDEwKTtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH1cbn07XG5leHBvcnQgZGVmYXVsdCBnZXRUb29sdGlwQ29vcmRpbmF0ZTtcbiJdfQ==